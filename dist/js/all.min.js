'use strict';

var _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if ("value" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();

function _possibleConstructorReturn(self, call) { if (!self) { throw new ReferenceError("this hasn't been initialised - super() hasn't been called"); } return call && (typeof call === "object" || typeof call === "function") ? call : self; }

function _inherits(subClass, superClass) { if (typeof superClass !== "function" && superClass !== null) { throw new TypeError("Super expression must either be null or a function, not " + typeof superClass); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, enumerable: false, writable: true, configurable: true } }); if (superClass) Object.setPrototypeOf ? Object.setPrototypeOf(subClass, superClass) : subClass.__proto__ = superClass; }

function _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError("Cannot call a class as a function"); } }

var Tent = function Tent(id, title, price, length, width, minPersons, maxPersons) {
  _classCallCheck(this, Tent);

  this.id = id;
  this.title = title;
  this.price = price;
  this.length = length;
  this.width = width;
  this.minPersons = minPersons;
  this.maxPersons = maxPersons;
  this.squareMeter = this.length * this.width;
};

var Equipment = function Equipment(id, title, price, description) {
  _classCallCheck(this, Equipment);

  this.id = id;
  this.title = title;
  this.price = price;
  this.description = description;
};

var WizardStep = function () {
  function WizardStep() {
    var name = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : '';
    var wizardForm = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : null;

    _classCallCheck(this, WizardStep);

    this.name = name;
    this.active = ko.observable(false);
    this.activeSubStep = ko.observable();
    this.wizardForm = wizardForm;
    this.isVisible = ko.computed(function () {
      return this.active() && !this.activeSubStep();
    }, this);
  }

  _createClass(WizardStep, [{
    key: 'openSubStep',
    value: function openSubStep(substep) {
      substep.active(true);
      this.activeSubStep(substep);
    }
  }, {
    key: 'closeSubStep',
    value: function closeSubStep() {
      this.activeSubStep().active(false);
      this.activeSubStep(null);
    }
  }, {
    key: 'removeDataRow',
    value: function removeDataRow() {
      throw new Error('Override this function');
    }
  }]);

  return WizardStep;
}();

var WizardSubStep = function (_WizardStep) {
  _inherits(WizardSubStep, _WizardStep);

  function WizardSubStep(parent) {
    var _ref;

    _classCallCheck(this, WizardSubStep);

    for (var _len = arguments.length, args = Array(_len > 1 ? _len - 1 : 0), _key = 1; _key < _len; _key++) {
      args[_key - 1] = arguments[_key];
    }

    var _this = _possibleConstructorReturn(this, (_ref = WizardSubStep.__proto__ || Object.getPrototypeOf(WizardSubStep)).call.apply(_ref, [this].concat(args)));

    _this.parent = parent;
    _this.isVisible = ko.computed(function () {
      return this.active() && this.parent.active();
    }, _this);
    return _this;
  }

  return WizardSubStep;
}(WizardStep);

var WizardStepTents = function (_WizardStep2) {
  _inherits(WizardStepTents, _WizardStep2);

  function WizardStepTents() {
    var _ref2;

    _classCallCheck(this, WizardStepTents);

    for (var _len2 = arguments.length, args = Array(_len2), _key2 = 0; _key2 < _len2; _key2++) {
      args[_key2] = arguments[_key2];
    }

    var _this2 = _possibleConstructorReturn(this, (_ref2 = WizardStepTents.__proto__ || Object.getPrototypeOf(WizardStepTents)).call.apply(_ref2, [this].concat(args)));

    _this2.selectTentsSubStep = new WizardStepSelectTents(_this2);
    _this2.openSubStep(_this2.selectTentsSubStep);
    return _this2;
  }

  _createClass(WizardStepTents, [{
    key: 'openSelectTent',
    value: function openSelectTent() {
      this.openSubStep(this.selectTentsSubStep);
    }
  }, {
    key: 'removeDataRow',
    value: function removeDataRow(tent) {
      this.wizardForm.selectedTents.remove(tent);
    }
  }]);

  return WizardStepTents;
}(WizardStep);

var WizardStepEquipments = function (_WizardStep3) {
  _inherits(WizardStepEquipments, _WizardStep3);

  function WizardStepEquipments() {
    var _ref3;

    _classCallCheck(this, WizardStepEquipments);

    for (var _len3 = arguments.length, args = Array(_len3), _key3 = 0; _key3 < _len3; _key3++) {
      args[_key3] = arguments[_key3];
    }

    var _this3 = _possibleConstructorReturn(this, (_ref3 = WizardStepEquipments.__proto__ || Object.getPrototypeOf(WizardStepEquipments)).call.apply(_ref3, [this].concat(args)));

    _this3.selectEquipmentSubStep = new WizardStepSelectEquipment(_this3);
    _this3.openSubStep(_this3.selectEquipmentSubStep);
    return _this3;
  }

  _createClass(WizardStepEquipments, [{
    key: 'openSelectEquipment',
    value: function openSelectEquipment() {
      this.openSubStep(this.selectEquipmentSubStep);
    }
  }, {
    key: 'removeDataRow',
    value: function removeDataRow(equipment) {
      this.wizardForm.selectedEquipments.remove(equipment);
    }
  }]);

  return WizardStepEquipments;
}(WizardStep);

var WizardStepEvent = function (_WizardStep4) {
  _inherits(WizardStepEvent, _WizardStep4);

  function WizardStepEvent() {
    _classCallCheck(this, WizardStepEvent);

    return _possibleConstructorReturn(this, (WizardStepEvent.__proto__ || Object.getPrototypeOf(WizardStepEvent)).apply(this, arguments));
  }

  return WizardStepEvent;
}(WizardStep);

var WizardStepContact = function (_WizardStep5) {
  _inherits(WizardStepContact, _WizardStep5);

  function WizardStepContact() {
    var _ref4;

    _classCallCheck(this, WizardStepContact);

    for (var _len4 = arguments.length, args = Array(_len4), _key4 = 0; _key4 < _len4; _key4++) {
      args[_key4] = arguments[_key4];
    }

    var _this5 = _possibleConstructorReturn(this, (_ref4 = WizardStepContact.__proto__ || Object.getPrototypeOf(WizardStepContact)).call.apply(_ref4, [this].concat(args)));

    _this5.availableGenders = ko.observableArray(['', 'Herr', 'Frau']);
    return _this5;
  }

  return WizardStepContact;
}(WizardStep);

var WizardStepSelectTents = function (_WizardSubStep) {
  _inherits(WizardStepSelectTents, _WizardSubStep);

  function WizardStepSelectTents(parent) {
    var _ref5;

    _classCallCheck(this, WizardStepSelectTents);

    for (var _len5 = arguments.length, args = Array(_len5 > 1 ? _len5 - 1 : 0), _key5 = 1; _key5 < _len5; _key5++) {
      args[_key5 - 1] = arguments[_key5];
    }

    return _possibleConstructorReturn(this, (_ref5 = WizardStepSelectTents.__proto__ || Object.getPrototypeOf(WizardStepSelectTents)).call.apply(_ref5, [this, parent].concat(args)));
  }

  _createClass(WizardStepSelectTents, [{
    key: 'selectTent',
    value: function selectTent(tent) {
      this.parent.wizardForm.selectedTents.push(Object.assign(new Tent(), tent));
      this.parent.closeSubStep();
    }
  }]);

  return WizardStepSelectTents;
}(WizardSubStep);

var WizardStepSelectEquipment = function (_WizardSubStep2) {
  _inherits(WizardStepSelectEquipment, _WizardSubStep2);

  function WizardStepSelectEquipment() {
    _classCallCheck(this, WizardStepSelectEquipment);

    return _possibleConstructorReturn(this, (WizardStepSelectEquipment.__proto__ || Object.getPrototypeOf(WizardStepSelectEquipment)).apply(this, arguments));
  }

  _createClass(WizardStepSelectEquipment, [{
    key: 'selectEquipment',
    value: function selectEquipment(equipment) {
      this.parent.wizardForm.selectedEquipments.push(Object.assign(new Equipment(), equipment));
      this.parent.closeSubStep();
    }
  }]);

  return WizardStepSelectEquipment;
}(WizardSubStep);

var WizardForm = function () {
  function WizardForm() {
    _classCallCheck(this, WizardForm);

    this.firstName = ko.observable();
    this.lastName = ko.observable();
    this.salutation = ko.observable();
    this.company = ko.observable();
    this.street = ko.observable();
    this.streetnr = ko.observable();
    this.zip = ko.observable();
    this.location = ko.observable();
    this.email = ko.observable();
    this.phone = ko.observable();
    this.eventdays = ko.observable(1);
    this.eventlocation = ko.observable();
    this.eventlocationdistance = ko.observable(0);

    this.tents = ko.observableArray();
    this.equipments = ko.observableArray();
    this.selectedTents = ko.observableArray();
    this.selectedEquipments = ko.observableArray();
    this.transportPrice = ko.computed(function () {
      if (this.eventlocationdistance() <= 10000) {
        return 0;
      } else {
        // 50.- each 30km * 2 (for twice the distance)
        return Math.ceil(this.eventlocationdistance() / 1000 / 30) * 50 * 2;
      }
    }, this);
    this.totalTentsPrice = ko.computed(function () {
      return this._count_objs_attribute(this.selectedTents(), 'price');
    }, this);
    this.totalEquipmentsPrice = ko.computed(function () {
      return this._count_objs_attribute(this.selectedEquipments(), 'price');
    }, this);
    this.totalPrice = ko.computed(function () {
      return (this.totalTentsPrice() + this.totalEquipmentsPrice()) * this.eventdays() + this.transportPrice();
    }, this);
    this.totalMinPersons = ko.computed(function () {
      return this._count_objs_attribute(this.selectedTents(), 'minPersons');
    }, this);
    this.totalMaxPersons = ko.computed(function () {
      return this._count_objs_attribute(this.selectedTents(), 'maxPersons');
    }, this);
    this.totalSquareMeters = ko.computed(function () {
      return this._count_objs_attribute(this.selectedTents(), 'squareMeter');
    }, this);
  }

  _createClass(WizardForm, [{
    key: '_count_objs_attribute',
    value: function _count_objs_attribute(objs, attr) {
      var total = 0;
      objs.forEach(function (obj) {
        total += obj[attr];
      });
      return total;
    }
  }]);

  return WizardForm;
}();

var Wizard = function () {
  function Wizard() {
    _classCallCheck(this, Wizard);

    this.debug = false;
    if (typeof ajaxurl === 'undefined') {
      // wordpress sets the ajaxurl in the global scope.
      // If the ajaxurl is not initialized, we are not in a wordpress
      // environment.
      this.debug = true;
    }
    this.form = new WizardForm();
    // 0 = Fillout, 1 = Success, 2 = Error, 3 = pending, 4 = FormValidation error
    this.mode = ko.observable(0);
    this.steps = ko.observableArray([new WizardStepTents('Zelt', this.form), new WizardStepEquipments('Zubehör', this.form), new WizardStepEvent('Anlass', this.form), new WizardStepContact('Kontakt', this.form)]);
    this.addressNotFound = ko.observable(false);
    this.currentStep = ko.observable(this.steps()[0]);
    this.isLastStep = ko.computed(function () {
      return this.currentWizardStepId() >= this.steps().length - 1;
    }, this);
    this.showPrevButton = ko.computed(function () {
      return this.currentWizardStepId() > 0;
    }, this);
    this.nextButtonText = ko.computed(function () {
      if (this.isLastStep()) {
        return "Offerte anfordern";
      }
      return "Weiter";
    }, this);
    this.showNextButton = true;
    ko.computed(function () {
      var _iteratorNormalCompletion = true;
      var _didIteratorError = false;
      var _iteratorError = undefined;

      try {
        for (var _iterator = this.steps()[Symbol.iterator](), _step; !(_iteratorNormalCompletion = (_step = _iterator.next()).done); _iteratorNormalCompletion = true) {
          var step = _step.value;

          step.active(false);
          if (this.currentStep() == step) {
            step.active(true);
          }
        }
      } catch (err) {
        _didIteratorError = true;
        _iteratorError = err;
      } finally {
        try {
          if (!_iteratorNormalCompletion && _iterator.return) {
            _iterator.return();
          }
        } finally {
          if (_didIteratorError) {
            throw _iteratorError;
          }
        }
      }
    }, this);

    this.loadData();
    jQuery(document).on('focusout', 'input[required], select[required]', function (self) {
      return function () {
        self.validateField(this);
      };
    }(this));
  }

  _createClass(Wizard, [{
    key: 'next',
    value: function next() {
      if (this.isLastStep()) {
        this.send();
      } else {
        this.currentStep(this.steps()[this.currentWizardStepId() + 1]);
      }
    }
  }, {
    key: 'previous',
    value: function previous() {
      this.currentStep(this.steps()[this.currentWizardStepId() - 1]);
    }
  }, {
    key: 'loadData',
    value: function loadData() {
      var self = this;
      var request = this._make_request({ action: 'kah_get_tents' });
      request.then(function (response) {
        var tents = [];
        var equipments = [];
        if (self.debug) {
          tents = [new Tent(1, 'Zelttitel 1', 15, 4, 20, 100, 150), new Tent(2, 'Zelttitel 2', 30, 8, 20, 200, 300), new Tent(3, 'Zelttitel 3', 50, 12, 20, 150, 300)];
          equipments = [new Equipment(1, 'Lampe', 5, 'kleine Lampe für das DJ Pult'), new Equipment(2, 'Bodenplatte 30x30 cm', 2, 'Um den Boden zu schützen'), new Equipment(3, 'Tisch - 3 Meter ', 9, "für 6 Personen"), new Equipment(4, 'Tisch - 5 Meter ', 9, "für 9 Personen")];
        } else {
          response.tents.forEach(function (tent) {
            tents.push(new Tent(tent.id, tent.title, tent.price, tent.length, tent.width, tent.minPersons, tent.maxPersons));
          });
          response.equipments.forEach(function (equipment) {
            equipments.push(new Equipment(equipment.id, equipment.title, equipment.price, equipment.description));
          });
        }
        self.form.tents(tents.sort(function (a, b) {
          return a.minPersons - b.minPersons;
        }));
        self.form.equipments(equipments);
      });
    }
  }, {
    key: 'send',
    value: function send() {
      jQuery(window).scrollTop(0);
      if (!this.validateForm()) {
        this.mode(4);
        return;
      }
      this.mode(3);
      var self = this;
      var data = {
        action: 'kah_send_tent_configurator',
        firstName: this.form.firstName(),
        lastName: this.form.lastName(),
        salutation: this.form.salutation(),
        company: this.form.company(),
        street: this.form.street(),
        streetnr: this.form.streetnr(),
        zip: this.form.zip(),
        location: this.form.location(),
        email: this.form.email(),
        phone: this.form.phone(),
        selectedTents: this.form.selectedTents(),
        selectedEquipments: this.form.selectedEquipments(),
        totalTentsPrice: this.form.totalTentsPrice(),
        totalEquipmentsPrice: this.form.totalEquipmentsPrice(),
        totalPrice: this.form.totalPrice(),
        totalMinPersons: this.form.totalMinPersons(),
        totalMaxPersons: this.form.totalMaxPersons(),
        totalSquareMeters: this.form.totalSquareMeters()
      };
      var request = this._make_request(data);
      request.then(function () {
        self.mode(1);
      }, function () {
        self.mode(2);
      });
    }
  }, {
    key: 'readablePrice',
    value: function readablePrice(price) {
      return price + ' CHF';
    }
  }, {
    key: 'readablePersons',
    value: function readablePersons(minPersons, maxPersons) {
      return minPersons + ' - ' + maxPersons + ' Personen';
    }
  }, {
    key: 'currentWizardStepId',
    value: function currentWizardStepId() {
      return this.steps().indexOf(this.currentStep());
    }
  }, {
    key: '_make_request',
    value: function _make_request(data) {
      var self = this;
      return new Promise(function (resolve, reject) {

        if (self.debug) {
          window.setTimeout(function () {
            resolve();
          }, 2000);
        } else {
          jQuery.post(ajaxurl, data).done(function (response) {
            resolve(response);
          }).fail(function (error) {
            reject(error);
          });
        }
      });
    }
  }, {
    key: 'validateForm',
    value: function validateForm() {
      var valid = true;
      var setInvalidForm = true;
      jQuery('input[required], select[required]').each(function (self) {
        return function (counter, field) {
          if (!self.validateField(field)) {
            valid = false;
            if (setInvalidForm) {
              self.currentStep(ko.dataFor(jQuery(field).closest('.wizardStepView')[0]));
              setInvalidForm = false;
            }
          }
        };
      }(this));
      return valid;
    }
  }, {
    key: 'validateField',
    value: function validateField(field) {
      var msgBox = field.previousElementSibling;
      if (msgBox === null) {
        msgBox = field.parentElement.previousElementSibling;
      }
      if (field.checkValidity()) {
        jQuery(msgBox).hide();
        return true;
      } else {
        msgBox.innerHTML = field.validationMessage;
        jQuery(msgBox).show();
        return false;
      }
    }
  }, {
    key: 'calculateDistance',
    value: function calculateDistance(place) {
      var self = this;
      if (typeof place === 'undefined') {
        self.addressNotFound(true);
        return;
      };

      var origin = 'Hauptstrasse 95, 1715 Alterswil, Schweiz';
      var destination = new google.maps.LatLng(place.geometry.location.lat(), place.geometry.location.lng());
      var service = new google.maps.DistanceMatrixService();
      service.getDistanceMatrix({
        origins: [origin],
        destinations: [destination],
        travelMode: google.maps.TravelMode.DRIVING }, function (response, status) {
        if (status == google.maps.DistanceMatrixStatus.OK) {
          var distancematrix = response.rows[0].elements[0];
          if (distancematrix.status == google.maps.DistanceMatrixStatus.OK) {
            self.form.eventlocationdistance(distancematrix.distance.value);
            self.addressNotFound(false);
          }
        }
      });
    }
  }, {
    key: 'initGoogleSearch',
    value: function initGoogleSearch() {
      // We call this funciton from outside. So we have to set 
      // the wizard itself to be able to access its functions.
      var self = window.wizard;
      jQuery(window).on('load', function () {
        var input = document.getElementById('eventlocation');
        var searchBox = new google.maps.places.SearchBox(input);
        searchBox.addListener('places_changed', function () {
          self.calculateDistance(searchBox.getPlaces()[0]);
        });
        google.maps.event.addDomListener(input, 'keydown', function (e) {
          if (e.keyCode == 13) {
            e.preventDefault();
          }
        });
      });
    }
  }]);

  return Wizard;
}();

window.wizard = new Wizard();
var initGoogleSearch = window.wizard.initGoogleSearch;

jQuery(window).on('load', function () {
  ko.applyBindings(window.wizard, document.getElementById('wizard-form'));
});
//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIm1haW4uanMiXSwibmFtZXMiOlsiVGVudCIsImlkIiwidGl0bGUiLCJwcmljZSIsImxlbmd0aCIsIndpZHRoIiwibWluUGVyc29ucyIsIm1heFBlcnNvbnMiLCJzcXVhcmVNZXRlciIsIkVxdWlwbWVudCIsImRlc2NyaXB0aW9uIiwiV2l6YXJkU3RlcCIsIm5hbWUiLCJ3aXphcmRGb3JtIiwiYWN0aXZlIiwia28iLCJvYnNlcnZhYmxlIiwiYWN0aXZlU3ViU3RlcCIsImlzVmlzaWJsZSIsImNvbXB1dGVkIiwic3Vic3RlcCIsIkVycm9yIiwiV2l6YXJkU3ViU3RlcCIsInBhcmVudCIsImFyZ3MiLCJXaXphcmRTdGVwVGVudHMiLCJzZWxlY3RUZW50c1N1YlN0ZXAiLCJXaXphcmRTdGVwU2VsZWN0VGVudHMiLCJvcGVuU3ViU3RlcCIsInRlbnQiLCJzZWxlY3RlZFRlbnRzIiwicmVtb3ZlIiwiV2l6YXJkU3RlcEVxdWlwbWVudHMiLCJzZWxlY3RFcXVpcG1lbnRTdWJTdGVwIiwiV2l6YXJkU3RlcFNlbGVjdEVxdWlwbWVudCIsImVxdWlwbWVudCIsInNlbGVjdGVkRXF1aXBtZW50cyIsIldpemFyZFN0ZXBFdmVudCIsIldpemFyZFN0ZXBDb250YWN0IiwiYXZhaWxhYmxlR2VuZGVycyIsIm9ic2VydmFibGVBcnJheSIsInB1c2giLCJPYmplY3QiLCJhc3NpZ24iLCJjbG9zZVN1YlN0ZXAiLCJXaXphcmRGb3JtIiwiZmlyc3ROYW1lIiwibGFzdE5hbWUiLCJzYWx1dGF0aW9uIiwiY29tcGFueSIsInN0cmVldCIsInN0cmVldG5yIiwiemlwIiwibG9jYXRpb24iLCJlbWFpbCIsInBob25lIiwiZXZlbnRkYXlzIiwiZXZlbnRsb2NhdGlvbiIsImV2ZW50bG9jYXRpb25kaXN0YW5jZSIsInRlbnRzIiwiZXF1aXBtZW50cyIsInRyYW5zcG9ydFByaWNlIiwiTWF0aCIsImNlaWwiLCJ0b3RhbFRlbnRzUHJpY2UiLCJfY291bnRfb2Jqc19hdHRyaWJ1dGUiLCJ0b3RhbEVxdWlwbWVudHNQcmljZSIsInRvdGFsUHJpY2UiLCJ0b3RhbE1pblBlcnNvbnMiLCJ0b3RhbE1heFBlcnNvbnMiLCJ0b3RhbFNxdWFyZU1ldGVycyIsIm9ianMiLCJhdHRyIiwidG90YWwiLCJmb3JFYWNoIiwib2JqIiwiV2l6YXJkIiwiZGVidWciLCJhamF4dXJsIiwiZm9ybSIsIm1vZGUiLCJzdGVwcyIsImFkZHJlc3NOb3RGb3VuZCIsImN1cnJlbnRTdGVwIiwiaXNMYXN0U3RlcCIsImN1cnJlbnRXaXphcmRTdGVwSWQiLCJzaG93UHJldkJ1dHRvbiIsIm5leHRCdXR0b25UZXh0Iiwic2hvd05leHRCdXR0b24iLCJzdGVwIiwibG9hZERhdGEiLCJqUXVlcnkiLCJkb2N1bWVudCIsIm9uIiwic2VsZiIsInZhbGlkYXRlRmllbGQiLCJzZW5kIiwicmVxdWVzdCIsIl9tYWtlX3JlcXVlc3QiLCJhY3Rpb24iLCJ0aGVuIiwicmVzcG9uc2UiLCJzb3J0IiwiYSIsImIiLCJ3aW5kb3ciLCJzY3JvbGxUb3AiLCJ2YWxpZGF0ZUZvcm0iLCJkYXRhIiwiaW5kZXhPZiIsIlByb21pc2UiLCJyZXNvbHZlIiwicmVqZWN0Iiwic2V0VGltZW91dCIsInBvc3QiLCJkb25lIiwiZmFpbCIsImVycm9yIiwidmFsaWQiLCJzZXRJbnZhbGlkRm9ybSIsImVhY2giLCJjb3VudGVyIiwiZmllbGQiLCJkYXRhRm9yIiwiY2xvc2VzdCIsIm1zZ0JveCIsInByZXZpb3VzRWxlbWVudFNpYmxpbmciLCJwYXJlbnRFbGVtZW50IiwiY2hlY2tWYWxpZGl0eSIsImhpZGUiLCJpbm5lckhUTUwiLCJ2YWxpZGF0aW9uTWVzc2FnZSIsInNob3ciLCJwbGFjZSIsIm9yaWdpbiIsImRlc3RpbmF0aW9uIiwiZ29vZ2xlIiwibWFwcyIsIkxhdExuZyIsImdlb21ldHJ5IiwibGF0IiwibG5nIiwic2VydmljZSIsIkRpc3RhbmNlTWF0cml4U2VydmljZSIsImdldERpc3RhbmNlTWF0cml4Iiwib3JpZ2lucyIsImRlc3RpbmF0aW9ucyIsInRyYXZlbE1vZGUiLCJUcmF2ZWxNb2RlIiwiRFJJVklORyIsInN0YXR1cyIsIkRpc3RhbmNlTWF0cml4U3RhdHVzIiwiT0siLCJkaXN0YW5jZW1hdHJpeCIsInJvd3MiLCJlbGVtZW50cyIsImRpc3RhbmNlIiwidmFsdWUiLCJ3aXphcmQiLCJpbnB1dCIsImdldEVsZW1lbnRCeUlkIiwic2VhcmNoQm94IiwicGxhY2VzIiwiU2VhcmNoQm94IiwiYWRkTGlzdGVuZXIiLCJjYWxjdWxhdGVEaXN0YW5jZSIsImdldFBsYWNlcyIsImV2ZW50IiwiYWRkRG9tTGlzdGVuZXIiLCJlIiwia2V5Q29kZSIsInByZXZlbnREZWZhdWx0IiwiaW5pdEdvb2dsZVNlYXJjaCIsImFwcGx5QmluZGluZ3MiXSwibWFwcGluZ3MiOiI7Ozs7Ozs7Ozs7SUFBTUEsT0FDSixjQUFZQyxFQUFaLEVBQWdCQyxLQUFoQixFQUF1QkMsS0FBdkIsRUFBOEJDLE1BQTlCLEVBQXNDQyxLQUF0QyxFQUE2Q0MsVUFBN0MsRUFBeURDLFVBQXpELEVBQXFFO0FBQUE7O0FBQ25FLE9BQUtOLEVBQUwsR0FBVUEsRUFBVjtBQUNBLE9BQUtDLEtBQUwsR0FBYUEsS0FBYjtBQUNBLE9BQUtDLEtBQUwsR0FBYUEsS0FBYjtBQUNBLE9BQUtDLE1BQUwsR0FBY0EsTUFBZDtBQUNBLE9BQUtDLEtBQUwsR0FBYUEsS0FBYjtBQUNBLE9BQUtDLFVBQUwsR0FBa0JBLFVBQWxCO0FBQ0EsT0FBS0MsVUFBTCxHQUFrQkEsVUFBbEI7QUFDQSxPQUFLQyxXQUFMLEdBQW1CLEtBQUtKLE1BQUwsR0FBYyxLQUFLQyxLQUF0QztBQUNEOztJQUdHSSxZQUNKLG1CQUFZUixFQUFaLEVBQWdCQyxLQUFoQixFQUF1QkMsS0FBdkIsRUFBOEJPLFdBQTlCLEVBQTJDO0FBQUE7O0FBQ3pDLE9BQUtULEVBQUwsR0FBVUEsRUFBVjtBQUNBLE9BQUtDLEtBQUwsR0FBYUEsS0FBYjtBQUNBLE9BQUtDLEtBQUwsR0FBYUEsS0FBYjtBQUNBLE9BQUtPLFdBQUwsR0FBbUJBLFdBQW5CO0FB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QixNQUFsQixFQUEwQixZQUFXO0FBQ25DLFlBQUlrRSxRQUFRbkUsU0FBU29FLGNBQVQsQ0FBd0IsZUFBeEIsQ0FBWjtBQUNBLFlBQUlDLFlBQVksSUFBSXpCLE9BQU9DLElBQVAsQ0FBWXlCLE1BQVosQ0FBbUJDLFNBQXZCLENBQWlDSixLQUFqQyxDQUFoQjtBQUNBRSxrQkFBVUcsV0FBVixDQUFzQixnQkFBdEIsRUFBd0MsWUFBVztBQUNqRHRFLGVBQUt1RSxpQkFBTCxDQUF1QkosVUFBVUssU0FBVixHQUFzQixDQUF0QixDQUF2QjtBQUNELFNBRkQ7QUFHQTlCLGVBQU9DLElBQVAsQ0FBWThCLEtBQVosQ0FBa0JDLGNBQWxCLENBQWlDVCxLQUFqQyxFQUF3QyxTQUF4QyxFQUFtRCxVQUFTVSxDQUFULEVBQVk7QUFDN0QsY0FBSUEsRUFBRUMsT0FBRixJQUFhLEVBQWpCLEVBQXFCO0FBQ2pCRCxjQUFFRSxjQUFGO0FBQ0g7QUFDRixTQUpEO0FBS0QsT0FYRDtBQVlEOzs7Ozs7QUFHSGxFLE9BQU9xRCxNQUFQLEdBQWdCLElBQUlsRixNQUFKLEVBQWhCO0FBQ0EsSUFBSWdHLG1CQUFtQm5FLE9BQU9xRCxNQUFQLENBQWNjLGdCQUFyQzs7QUFFQWpGLE9BQU9jLE1BQVAsRUFBZVosRUFBZixDQUFrQixNQUFsQixFQUEwQixZQUFXO0FBQ25DOUUsS0FBRzhKLGFBQUgsQ0FBaUJwRSxPQUFPcUQsTUFBeEIsRUFBZ0NsRSxTQUFTb0UsY0FBVCxDQUF3QixhQUF4QixDQUFoQztBQUNELENBRkQiLCJmaWxlIjoiYWxsLm1pbi5qcyIsInNvdXJjZXNDb250ZW50IjpbImNsYXNzIFRlbnQge1xuICBjb25zdHJ1Y3RvcihpZCwgdGl0bGUsIHByaWNlLCBsZW5ndGgsIHdpZHRoLCBtaW5QZXJzb25zLCBtYXhQZXJzb25zKSB7XG4gICAgdGhpcy5pZCA9IGlkO1xuICAgIHRoaXMudGl0bGUgPSB0aXRsZTtcbiAgICB0aGlzLnByaWNlID0gcHJpY2U7XG4gICAgdGhpcy5sZW5ndGggPSBsZW5ndGg7XG4gICAgdGhpcy53aWR0aCA9IHdpZHRoO1xuICAgIHRoaXMubWluUGVyc29ucyA9IG1pblBlcnNvbnM7XG4gICAgdGhpcy5tYXhQZXJzb25zID0gbWF4UGVyc29ucztcbiAgICB0aGlzLnNxdWFyZU1ldGVyID0gdGhpcy5sZW5ndGggKiB0aGlzLndpZHRoO1xuICB9XG59XG5cbmNsYXNzIEVxdWlwbWVudCB7XG4gIGNvbnN0cnVjdG9yKGlkLCB0aXRsZSwgcHJpY2UsIGRlc2NyaXB0aW9uKSB7XG4gICAgdGhpcy5pZCA9IGlkO1xuICAgIHRoaXMudGl0bGUgPSB0aXRsZTtcbiAgICB0aGlzLnByaWNlID0gcHJpY2U7IFxuICAgIHRoaXMuZGVzY3JpcHRpb24gPSBkZXNjcmlwdGlvbjtcbiAgfVxufVxuXG5jbGFzcyBXaXphcmRTdGVwIHtcbiAgY29uc3RydWN0b3IobmFtZT0nJywgd2l6YXJkRm9ybT1udWxsKSB7XG4gICAgdGhpcy5uYW1lID0gbmFtZTtcbiAgICB0aGlzLmFjdGl2ZSA9IGtvLm9ic2VydmFibGUoZmFsc2UpO1xuICAgIHRoaXMuYWN0aXZlU3ViU3RlcCA9IGtvLm9ic2VydmFibGUoKTtcbiAgICB0aGlzLndpemFyZEZvcm0gPSB3aXphcmRGb3JtO1xuICAgIHRoaXMuaXNWaXNpYmxlID0ga28uY29tcHV0ZWQoZnVuY3Rpb24oKSB7XG4gICAgICByZXR1cm4gdGhpcy5hY3RpdmUoKSAmJiAhdGhpcy5hY3RpdmVTdWJTdGVwKCk7XG4gICAgfSwgdGhpcyk7XG4gIH1cbiAgb3BlblN1YlN0ZXAoc3Vic3RlcCkge1xuICAgIHN1YnN0ZXAuYWN0aXZlKHRydWUpO1xuICAgIHRoaXMuYWN0aXZlU3ViU3RlcChzdWJzdGVwKTtcbiAgfVxuICBjbG9zZVN1YlN0ZXAoKSB7XG4gICAgdGhpcy5hY3RpdmVTdWJTdGVwKCkuYWN0aXZlKGZhbHNlKTtcbiAgICB0aGlzLmFjdGl2ZVN1YlN0ZXAobnVsbCk7XG4gIH1cbiAgcmVtb3ZlRGF0YVJvdygpIHsgdGhyb3cgbmV3IEVycm9yKCdPdmVycmlkZSB0aGlzIGZ1bmN0aW9uJyk7IH1cbn1cblxuY2xhc3MgV2l6YXJkU3ViU3RlcCBleHRlbmRzIFdpemFyZFN0ZXAge1xuICBjb25zdHJ1Y3RvcihwYXJlbnQsIC4uLmFyZ3MpIHtcbiAgICBzdXBlciguLi5hcmdzKTtcbiAgICB0aGlzLnBhcmVudCA9IHBhcmVudDtcbiAgICB0aGlzLmlzVmlzaWJsZSA9IGtvLmNvbXB1dGVkKGZ1bmN0aW9uKCkge1xuICAgICAgcmV0dXJuIHRoaXMuYWN0aXZlKCkgJiYgdGhpcy5wYXJlbnQuYWN0aXZlKCk7XG4gICAgfSwgdGhpcyk7XG4gIH1cbn1cbmNsYXNzIFdpemFyZFN0ZXBUZW50cyBleHRlbmRzIFdpemFyZFN0ZXAge1xuICBjb25zdHJ1Y3RvciguLi5hcmdzKSB7XG4gICAgc3VwZXIoLi4uYXJncyk7XG4gICAgdGhpcy5zZWxlY3RUZW50c1N1YlN0ZXAgPSBuZXcgV2l6YXJkU3RlcFNlbGVjdFRlbnRzKHRoaXMpO1xuICAgIHRoaXMub3BlblN1YlN0ZXAodGhpcy5zZWxlY3RUZW50c1N1YlN0ZXApO1xuICB9XG4gIG9wZW5TZWxlY3RUZW50KCkge1xuICAgIHRoaXMub3BlblN1YlN0ZXAodGhpcy5zZWxlY3RUZW50c1N1YlN0ZXApO1xuICB9XG4gIHJlbW92ZURhdGFSb3codGVudCkge1xuICAgIHRoaXMud2l6YXJkRm9ybS5zZWxlY3RlZFRlbnRzLnJlbW92ZSh0ZW50KTtcbiAgfVxufVxuXG5jbGFzcyBXaXphcmRTdGVwRXF1aXBtZW50cyBleHRlbmRzIFdpemFyZFN0ZXAge1xuICBjb25zdHJ1Y3RvciguLi5hcmdzKSB7XG4gICAgc3VwZXIoLi4uYXJncyk7XG4gICAgdGhpcy5zZWxlY3RFcXVpcG1lbnRTdWJTdGVwID0gbmV3IFdpemFyZFN0ZXBTZWxlY3RFcXVpcG1lbnQodGhpcyk7XG4gICAgdGhpcy5vcGVuU3ViU3RlcCh0aGlzLnNlbGVjdEVxdWlwbWVudFN1YlN0ZXApO1xuICB9XG4gIG9wZW5TZWxlY3RFcXVpcG1lbnQoKSB7XG4gICAgdGhpcy5vcGVuU3ViU3RlcCh0aGlzLnNlbGVjdEVxdWlwbWVudFN1YlN0ZXApO1xuICB9XG4gIHJlbW92ZURhdGFSb3coZXF1aXBtZW50KSB7XG4gICAgdGhpcy53aXphcmRGb3JtLnNlbGVjdGVkRXF1aXBtZW50cy5yZW1vdmUoZXF1aXBtZW50KTtcbiAgfSBcbn1cblxuY2xhc3MgV2l6YXJkU3RlcEV2ZW50IGV4dGVuZHMgV2l6YXJkU3RlcCB7XG59XG5cblxuY2xhc3MgV2l6YXJkU3RlcENvbnRhY3QgZXh0ZW5kcyBXaXphcmRTdGVwIHtcbiAgY29uc3RydWN0b3IoLi4uYXJncykge1xuICAgIHN1cGVyKC4uLmFyZ3MpO1xuICAgIHRoaXMuYXZhaWxhYmxlR2VuZGVycyA9IGtvLm9ic2VydmFibGVBcnJheShbJycsICdIZXJyJywgJ0ZyYXUnXSk7XG4gIH1cbn1cblxuY2xhc3MgV2l6YXJkU3RlcFNlbGVjdFRlbnRzIGV4dGVuZHMgV2l6YXJkU3ViU3RlcCB7XG4gIGNvbnN0cnVjdG9yKHBhcmVudCwgLi4uYXJncykge1xuICAgIHN1cGVyKHBhcmVudCwgLi4uYXJncyk7XG4gIH1cbiAgc2VsZWN0VGVudCh0ZW50KSB7XG4gICAgdGhpcy5wYXJlbnQud2l6YXJkRm9ybS5zZWxlY3RlZFRlbnRzLnB1c2goT2JqZWN0LmFzc2lnbihuZXcgVGVudCgpLCB0ZW50KSk7XG4gICAgdGhpcy5wYXJlbnQuY2xvc2VTdWJTdGVwKCk7XG4gIH1cbn1cblxuY2xhc3MgV2l6YXJkU3RlcFNlbGVjdEVxdWlwbWVudCBleHRlbmRzIFdpemFyZFN1YlN0ZXAge1xuICBzZWxlY3RFcXVpcG1lbnQoZXF1aXBtZW50KSB7XG4gICAgdGhpcy5wYXJlbnQud2l6YXJkRm9ybS5zZWxlY3RlZEVxdWlwbWVudHMucHVzaChPYmplY3QuYXNzaWduKG5ldyBFcXVpcG1lbnQoKSwgZXF1aXBtZW50KSk7XG4gICAgdGhpcy5wYXJlbnQuY2xvc2VTdWJTdGVwKCk7XG4gIH1cbn1cbmNsYXNzIFdpemFyZEZvcm0ge1xuICBjb25zdHJ1Y3RvcigpIHtcbiAgICB0aGlzLmZpcnN0TmFtZSA9IGtvLm9ic2VydmFibGUoKTtcbiAgICB0aGlzLmxhc3ROYW1lID0ga28ub2JzZXJ2YWJsZSgpO1xuICAgIHRoaXMuc2FsdXRhdGlvbiA9IGtvLm9ic2VydmFibGUoKTtcbiAgICB0aGlzLmNvbXBhbnkgPSBrby5vYnNlcnZhYmxlKCk7XG4gICAgdGhpcy5zdHJlZXQgPSBrby5vYnNlcnZhYmxlKCk7XG4gICAgdGhpcy5zdHJlZXRuciA9IGtvLm9ic2VydmFibGUoKTtcbiAgICB0aGlzLnppcCA9IGtvLm9ic2VydmFibGUoKTtcbiAgICB0aGlzLmxvY2F0aW9uID0ga28ub2JzZXJ2YWJsZSgpO1xuICAgIHRoaXMuZW1haWwgPSBrby5vYnNlcnZhYmxlKCk7XG4gICAgdGhpcy5waG9uZSA9IGtvLm9ic2VydmFibGUoKTtcbiAgICB0aGlzLmV2ZW50ZGF5cyA9IGtvLm9ic2VydmFibGUoMSk7XG4gICAgdGhpcy5ldmVudGxvY2F0aW9uID0ga28ub2JzZXJ2YWJsZSgpO1xuICAgIHRoaXMuZXZlbnRsb2NhdGlvbmRpc3RhbmNlID0ga28ub2JzZXJ2YWJsZSgwKTtcblxuICAgIHRoaXMudGVudHMgPSBrby5vYnNlcnZhYmxlQXJyYXkoKTtcbiAgICB0aGlzLmVxdWlwbWVudHMgPSBrby5vYnNlcnZhYmxlQXJyYXkoKTtcbiAgICB0aGlzLnNlbGVjdGVkVGVudHMgPSBrby5vYnNlcnZhYmxlQXJyYXkoKTtcbiAgICB0aGlzLnNlbGVjdGVkRXF1aXBtZW50cyA9IGtvLm9ic2VydmFibGVBcnJheSgpO1xuICAgIHRoaXMudHJhbnNwb3J0UHJpY2UgPSBrby5jb21wdXRlZChmdW5jdGlvbigpIHtcbiAgICAgIGlmICggdGhpcy5ldmVudGxvY2F0aW9uZGlzdGFuY2UoKSA8PSAxMDAwMCApIHtcbiAgICAgICAgcmV0dXJuIDA7XG4gICAgICB9IGVsc2Uge1xuICAgICAgICAvLyA1MC4tIGVhY2ggMzBrbSAqIDIgKGZvciB0d2ljZSB0aGUgZGlzdGFuY2UpXG4gICAgICAgIHJldHVybiBNYXRoLmNlaWwodGhpcy5ldmVudGxvY2F0aW9uZGlzdGFuY2UoKSAvIDEwMDAgLyAzMCkgKiA1MCAqIDI7XG4gICAgICB9XG4gICAgfSwgdGhpcyk7XG4gICAgdGhpcy50b3RhbFRlbnRzUHJpY2UgPSBrby5jb21wdXRlZChmdW5jdGlvbigpIHtcbiAgICAgIHJldHVybiB0aGlzLl9jb3VudF9vYmpzX2F0dHJpYnV0ZSh0aGlzLnNlbGVjdGVkVGVudHMoKSwgJ3ByaWNlJyk7XG4gICAgfSwgdGhpcyk7XG4gICAgdGhpcy50b3RhbEVxdWlwbWVudHNQcmljZSA9IGtvLmNvbXB1dGVkKGZ1bmN0aW9uKCkge1xuICAgICAgcmV0dXJuIHRoaXMuX2NvdW50X29ianNfYXR0cmlidXRlKHRoaXMuc2VsZWN0ZWRFcXVpcG1lbnRzKCksICdwcmljZScpO1xuICAgIH0sIHRoaXMpO1xuICAgIHRoaXMudG90YWxQcmljZSA9IGtvLmNvbXB1dGVkKGZ1bmN0aW9uKCkge1xuICAgICAgcmV0dXJuICh0aGlzLnRvdGFsVGVudHNQcmljZSgpICsgdGhpcy50b3RhbEVxdWlwbWVudHNQcmljZSgpKSAqIHRoaXMuZXZlbnRkYXlzKCkgKyB0aGlzLnRyYW5zcG9ydFByaWNlKCk7XG4gICAgfSwgdGhpcyk7XG4gICAgdGhpcy50b3RhbE1pblBlcnNvbnMgPSBrby5jb21wdXRlZChmdW5jdGlvbigpIHtcbiAgICAgIHJldHVybiB0aGlzLl9jb3VudF9vYmpzX2F0dHJpYnV0ZSh0aGlzLnNlbGVjdGVkVGVudHMoKSwgJ21pblBlcnNvbnMnKTtcbiAgICB9LCB0aGlzKTtcbiAgICB0aGlzLnRvdGFsTWF4UGVyc29ucyA9IGtvLmNvbXB1dGVkKGZ1bmN0aW9uKCkge1xuICAgICAgcmV0dXJuIHRoaXMuX2NvdW50X29ianNfYXR0cmlidXRlKHRoaXMuc2VsZWN0ZWRUZW50cygpLCAnbWF4UGVyc29ucycpO1xuICAgIH0sIHRoaXMpO1xuICAgIHRoaXMudG90YWxTcXVhcmVNZXRlcnMgPSBrby5jb21wdXRlZChmdW5jdGlvbigpIHtcbiAgICAgIHJldHVybiB0aGlzLl9jb3VudF9vYmpzX2F0dHJpYnV0ZSh0aGlzLnNlbGVjdGVkVGVudHMoKSwgJ3NxdWFyZU1ldGVyJyk7XG4gICAgfSwgdGhpcyk7XG4gIH1cbiAgX2NvdW50X29ianNfYXR0cmlidXRlKG9ianMsIGF0dHIpIHtcbiAgICBsZXQgdG90YWwgPSAwO1xuICAgIG9ianMuZm9yRWFjaChmdW5jdGlvbihvYmopIHsgdG90YWwgKz0gb2JqW2F0dHJdOyB9KTtcbiAgICByZXR1cm4gdG90YWw7XG4gIH1cbn1cblxuY2xhc3MgV2l6YXJkIHtcbiAgY29uc3RydWN0b3IoKSB7XG4gICAgdGhpcy5kZWJ1ZyA9IGZhbHNlO1xuICAgIGlmICh0eXBlb2YgYWpheHVybCA9PT0gJ3VuZGVmaW5lZCcgKSB7XG4gICAgICAvLyB3b3JkcHJlc3Mgc2V0cyB0aGUgYWpheHVybCBpbiB0aGUgZ2xvYmFsIHNjb3BlLlxuICAgICAgLy8gSWYgdGhlIGFqYXh1cmwgaXMgbm90IGluaXRpYWxpemVkLCB3ZSBhcmUgbm90IGluIGEgd29yZHByZXNzXG4gICAgICAvLyBlbnZpcm9ubWVudC5cbiAgICAgIHRoaXMuZGVidWcgPSB0cnVlO1xuICAgIH1cbiAgICB0aGlzLmZvcm0gPSBuZXcgV2l6YXJkRm9ybSgpO1xuICAgIC8vIDAgPSBGaWxsb3V0LCAxID0gU3VjY2VzcywgMiA9IEVycm9yLCAzID0gcGVuZGluZywgNCA9IEZvcm1WYWxpZGF0aW9uIGVycm9yXG4gICAgdGhpcy5tb2RlID0ga28ub2JzZXJ2YWJsZSgwKTtcbiAgICB0aGlzLnN0ZXBzID0ga28ub2JzZXJ2YWJsZUFycmF5KFtcbiAgICAgIG5ldyBXaXphcmRTdGVwVGVudHMoJ1plbHQnLCB0aGlzLmZvcm0pLFxuICAgICAgbmV3IFdpemFyZFN0ZXBFcXVpcG1lbnRzKCdadWJlaMO2cicsIHRoaXMuZm9ybSksXG4gICAgICBuZXcgV2l6YXJkU3RlcEV2ZW50KCdBbmxhc3MnLCB0aGlzLmZvcm0pLFxuICAgICAgbmV3IFdpemFyZFN0ZXBDb250YWN0KCdLb250YWt0JywgdGhpcy5mb3JtKVxuICAgIF0pO1xuICAgIHRoaXMuYWRkcmVzc05vdEZvdW5kID0ga28ub2JzZXJ2YWJsZShmYWxzZSk7XG4gICAgdGhpcy5jdXJyZW50U3RlcCA9IGtvLm9ic2VydmFibGUodGhpcy5zdGVwcygpWzBdKTtcbiAgICB0aGlzLmlzTGFzdFN0ZXAgPSBrby5jb21wdXRlZChmdW5jdGlvbigpIHtcbiAgICAgIHJldHVybiB0aGlzLmN1cnJlbnRXaXphcmRTdGVwSWQoKSA+PSB0aGlzLnN0ZXBzKCkubGVuZ3RoIC0gMTtcbiAgICB9LCB0aGlzKTtcbiAgICB0aGlzLnNob3dQcmV2QnV0dG9uID0ga28uY29tcHV0ZWQoZnVuY3Rpb24oKSB7XG4gICAgICByZXR1cm4gdGhpcy5jdXJyZW50V2l6YXJkU3RlcElkKCkgPiAwO1xuICAgIH0sIHRoaXMpO1xuICAgIHRoaXMubmV4dEJ1dHRvblRleHQgPSBrby5jb21wdXRlZChmdW5jdGlvbigpIHtcbiAgICAgIGlmICggdGhpcy5pc0xhc3RTdGVwKCkgKSB7XG4gICAgICAgIHJldHVybiBcIk9mZmVydGUgYW5mb3JkZXJuXCI7XG4gICAgICB9XG4gICAgICByZXR1cm4gXCJXZWl0ZXJcIjtcbiAgICB9LCB0aGlzKTtcbiAgICB0aGlzLnNob3dOZXh0QnV0dG9uID0gdHJ1ZTtcbiAgICBrby5jb21wdXRlZChmdW5jdGlvbigpIHtcbiAgICAgIGZvciAobGV0IHN0ZXAgb2YgdGhpcy5zdGVwcygpKSB7XG4gICAgICAgIHN0ZXAuYWN0aXZlKGZhbHNlKTtcbiAgICAgICAgaWYgKCB0aGlzLmN1cnJlbnRTdGVwKCkgPT0gc3RlcCApIHtcbiAgICAgICAgICBzdGVwLmFjdGl2ZSh0cnVlKTtcbiAgICAgICAgfVxuICAgICAgfVxuICAgIH0sIHRoaXMpO1xuXG4gICAgdGhpcy5sb2FkRGF0YSgpO1xuICAgIGpRdWVyeShkb2N1bWVudCkub24oJ2ZvY3Vzb3V0JywgJ2lucHV0W3JlcXVpcmVkXSwgc2VsZWN0W3JlcXVpcmVkXScsIGZ1bmN0aW9uKHNlbGYpIHtcbiAgICAgIHJldHVybiBmdW5jdGlvbigpIHtcbiAgICAgICAgc2VsZi52YWxpZGF0ZUZpZWxkKHRoaXMpO1xuICAgICAgfTtcbiAgICB9KHRoaXMpKTtcbiAgfVxuICBuZXh0KCkge1xuICAgIGlmICggdGhpcy5pc0xhc3RTdGVwKCkgKSB7XG4gICAgICB0aGlzLnNlbmQoKTtcbiAgICB9IGVsc2Uge1xuICAgICAgdGhpcy5jdXJyZW50U3RlcCh0aGlzLnN0ZXBzKClbdGhpcy5jdXJyZW50V2l6YXJkU3RlcElkKCkgKyAxXSk7XG4gICAgfVxuICB9XG4gIHByZXZpb3VzKCkge1xuICAgIHRoaXMuY3VycmVudFN0ZXAodGhpcy5zdGVwcygpW3RoaXMuY3VycmVudFdpemFyZFN0ZXBJZCgpIC0xXSk7XG4gIH1cbiAgbG9hZERhdGEoKSB7XG4gICAgbGV0IHNlbGYgPSB0aGlzO1xuICAgIGxldCByZXF1ZXN0ID0gdGhpcy5fbWFrZV9yZXF1ZXN0KHthY3Rpb246ICdrYWhfZ2V0X3RlbnRzJ30pO1xuICAgIHJlcXVlc3QudGhlbihcbiAgICAgIGZ1bmN0aW9uKHJlc3BvbnNlKSB7XG4gICAgICAgIGxldCB0ZW50cyA9IFtdO1xuICAgICAgICBsZXQgZXF1aXBtZW50cyA9IFtdO1xuICAgICAgICBpZiAoc2VsZi5kZWJ1Zykge1xuICAgICAgICAgIHRlbnRzID0gW1xuICAgICAgICAgICAgbmV3IFRlbnQoMSwgJ1plbHR0aXRlbCAxJywgMTUsIDQsIDIwLCAxMDAsIDE1MCksXG4gICAgICAgICAgICBuZXcgVGVudCgyLCAnWmVsdHRpdGVsIDInLCAzMCwgOCwgMjAsIDIwMCwgMzAwKSxcbiAgICAgICAgICAgIG5ldyBUZW50KDMsICdaZWx0dGl0ZWwgMycsIDUwLCAxMiwgMjAsIDE1MCwgMzAwKSxcbiAgICAgICAgICBdO1xuICAgICAgICAgIGVxdWlwbWVudHMgPSBbXG4gICAgICAgICAgICBuZXcgRXF1aXBtZW50KDEsICdMYW1wZScsIDUsICdrbGVpbmUgTGFtcGUgZsO8ciBkYXMgREogUHVsdCcpLFxuICAgICAgICAgICAgbmV3IEVxdWlwbWVudCgyLCAnQm9kZW5wbGF0dGUgMzB4MzAgY20nLCAyLCAnVW0gZGVuIEJvZGVuIHp1IHNjaMO8dHplbicpLFxuICAgICAgICAgICAgbmV3IEVxdWlwbWVudCgzLCAnVGlzY2ggLSAzIE1ldGVyICcsIDksIFwiZsO8ciA2IFBlcnNvbmVuXCIpLFxuICAgICAgICAgICAgbmV3IEVxdWlwbWVudCg0LCAnVGlzY2ggLSA1IE1ldGVyICcsIDksIFwiZsO8ciA5IFBlcnNvbmVuXCIpXG4gICAgICAgICAgXTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICByZXNwb25zZS50ZW50cy5mb3JFYWNoKGZ1bmN0aW9uKHRlbnQpIHtcbiAgICAgICAgICAgIHRlbnRzLnB1c2gobmV3IFRlbnQoXG4gICAgICAgICAgICAgIHRlbnQuaWQsXG4gICAgICAgICAgICAgIHRlbnQudGl0bGUsXG4gICAgICAgICAgICAgIHRlbnQucHJpY2UsXG4gICAgICAgICAgICAgIHRlbnQubGVuZ3RoLFxuICAgICAgICAgICAgICB0ZW50LndpZHRoLFxuICAgICAgICAgICAgICB0ZW50Lm1pblBlcnNvbnMsXG4gICAgICAgICAgICAgIHRlbnQubWF4UGVyc29ucykpO1xuICAgICAgICAgIH0pO1xuICAgICAgICAgIHJlc3BvbnNlLmVxdWlwbWVudHMuZm9yRWFjaChmdW5jdGlvbihlcXVpcG1lbnQpIHtcbiAgICAgICAgICAgIGVxdWlwbWVudHMucHVzaChuZXcgRXF1aXBtZW50KFxuICAgICAgICAgICAgICBlcXVpcG1lbnQuaWQsXG4gICAgICAgICAgICAgIGVxdWlwbWVudC50aXRsZSxcbiAgICAgICAgICAgICAgZXF1aXBtZW50LnByaWNlLFxuICAgICAgICAgICAgICBlcXVpcG1lbnQuZGVzY3JpcHRpb24pKTtcbiAgICAgICAgICB9KTtcbiAgICAgICAgfVxuICAgICAgICBzZWxmLmZvcm0udGVudHModGVudHMuc29ydCgoYSwgYikgPT4gYS5taW5QZXJzb25zIC0gYi5taW5QZXJzb25zKSk7XG4gICAgICAgIHNlbGYuZm9ybS5lcXVpcG1lbnRzKGVxdWlwbWVudHMpO1xuICAgICAgfSk7XG4gIH1cbiAgc2VuZCgpIHtcbiAgICBqUXVlcnkod2luZG93KS5zY3JvbGxUb3AoMCk7XG4gICAgaWYgKCAhdGhpcy52YWxpZGF0ZUZvcm0oKSApIHtcbiAgICAgIHRoaXMubW9kZSg0KTtcbiAgICAgIHJldHVybjtcbiAgICB9XG4gICAgdGhpcy5tb2RlKDMpO1xuICAgIGxldCBzZWxmID0gdGhpcztcbiAgICBsZXQgZGF0YSA9IHtcbiAgICAgIGFjdGlvbjogJ2thaF9zZW5kX3RlbnRfY29uZmlndXJhdG9yJyxcbiAgICAgIGZpcnN0TmFtZTogdGhpcy5mb3JtLmZpcnN0TmFtZSgpLFxuICAgICAgbGFzdE5hbWU6IHRoaXMuZm9ybS5sYXN0TmFtZSgpLFxuICAgICAgc2FsdXRhdGlvbjogdGhpcy5mb3JtLnNhbHV0YXRpb24oKSxcbiAgICAgIGNvbXBhbnk6IHRoaXMuZm9ybS5jb21wYW55KCksXG4gICAgICBzdHJlZXQ6IHRoaXMuZm9ybS5zdHJlZXQoKSxcbiAgICAgIHN0cmVldG5yOiB0aGlzLmZvcm0uc3RyZWV0bnIoKSxcbiAgICAgIHppcDogdGhpcy5mb3JtLnppcCgpLFxuICAgICAgbG9jYXRpb246IHRoaXMuZm9ybS5sb2NhdGlvbigpLFxuICAgICAgZW1haWw6IHRoaXMuZm9ybS5lbWFpbCgpLFxuICAgICAgcGhvbmU6IHRoaXMuZm9ybS5waG9uZSgpLFxuICAgICAgc2VsZWN0ZWRUZW50czogdGhpcy5mb3JtLnNlbGVjdGVkVGVudHMoKSxcbiAgICAgIHNlbGVjdGVkRXF1aXBtZW50czogdGhpcy5mb3JtLnNlbGVjdGVkRXF1aXBtZW50cygpLFxuICAgICAgdG90YWxUZW50c1ByaWNlOiB0aGlzLmZvcm0udG90YWxUZW50c1ByaWNlKCksXG4gICAgICB0b3RhbEVxdWlwbWVudHNQcmljZTogdGhpcy5mb3JtLnRvdGFsRXF1aXBtZW50c1ByaWNlKCksXG4gICAgICB0b3RhbFByaWNlOiB0aGlzLmZvcm0udG90YWxQcmljZSgpLFxuICAgICAgdG90YWxNaW5QZXJzb25zOiB0aGlzLmZvcm0udG90YWxNaW5QZXJzb25zKCksXG4gICAgICB0b3RhbE1heFBlcnNvbnM6IHRoaXMuZm9ybS50b3RhbE1heFBlcnNvbnMoKSxcbiAgICAgIHRvdGFsU3F1YXJlTWV0ZXJzOiB0aGlzLmZvcm0udG90YWxTcXVhcmVNZXRlcnMoKVxuICAgIH07XG4gICAgbGV0IHJlcXVlc3QgPSB0aGlzLl9tYWtlX3JlcXVlc3QoZGF0YSk7XG4gICAgcmVxdWVzdC50aGVuKFxuICAgICAgZnVuY3Rpb24oKSB7IHNlbGYubW9kZSgxKTsgfSxcbiAgICAgIGZ1bmN0aW9uKCkgeyBzZWxmLm1vZGUoMik7IH0pO1xuICB9XG4gIHJlYWRhYmxlUHJpY2UocHJpY2UpIHtcbiAgICByZXR1cm4gcHJpY2UgKyAnIENIRic7XG4gIH1cbiAgcmVhZGFibGVQZXJzb25zKG1pblBlcnNvbnMsIG1heFBlcnNvbnMpIHtcbiAgICByZXR1cm4gbWluUGVyc29ucyArICcgLSAnICsgbWF4UGVyc29ucyArICcgUGVyc29uZW4nO1xuICB9XG4gIGN1cnJlbnRXaXphcmRTdGVwSWQoKSB7XG4gICAgcmV0dXJuIHRoaXMuc3RlcHMoKS5pbmRleE9mKHRoaXMuY3VycmVudFN0ZXAoKSk7XG4gIH1cbiAgX21ha2VfcmVxdWVzdChkYXRhKSB7XG4gICAgbGV0IHNlbGYgPSB0aGlzO1xuICAgIHJldHVybiBuZXcgUHJvbWlzZShmdW5jdGlvbihyZXNvbHZlLCByZWplY3QpIHtcblxuICAgICAgaWYgKCBzZWxmLmRlYnVnICkge1xuICAgICAgICB3aW5kb3cuc2V0VGltZW91dChmdW5jdGlvbigpIHtcbiAgICAgICAgICByZXNvbHZlKCk7XG4gICAgICAgIH0sIDIwMDApO1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgalF1ZXJ5LnBvc3QoYWpheHVybCwgZGF0YSlcbiAgICAgICAgICAuZG9uZShmdW5jdGlvbihyZXNwb25zZSkgeyByZXNvbHZlKHJlc3BvbnNlKTsgfSlcbiAgICAgICAgICAuZmFpbChmdW5jdGlvbihlcnJvcikgeyByZWplY3QoZXJyb3IpOyB9KTtcbiAgICAgIH1cbiAgICB9KTtcbiAgfVxuICB2YWxpZGF0ZUZvcm0oKSB7XG4gICAgbGV0IHZhbGlkID0gdHJ1ZTtcbiAgICBsZXQgc2V0SW52YWxpZEZvcm0gPSB0cnVlO1xuICAgIGpRdWVyeSgnaW5wdXRbcmVxdWlyZWRdLCBzZWxlY3RbcmVxdWlyZWRdJykuZWFjaChmdW5jdGlvbihzZWxmKSB7XG4gICAgICByZXR1cm4gZnVuY3Rpb24oY291bnRlciwgZmllbGQpIHtcbiAgICAgICAgaWYgKCAhc2VsZi52YWxpZGF0ZUZpZWxkKGZpZWxkKSApIHsgXG4gICAgICAgICAgdmFsaWQgPSBmYWxzZTtcbiAgICAgICAgICBpZiAoIHNldEludmFsaWRGb3JtICkge1xuICAgICAgICAgICAgc2VsZi5jdXJyZW50U3RlcChcbiAgICAgICAgICAgICAga28uZGF0YUZvcihqUXVlcnkoZmllbGQpLmNsb3Nlc3QoJy53aXphcmRTdGVwVmlldycpWzBdKVxuICAgICAgICAgICAgKTtcbiAgICAgICAgICAgIHNldEludmFsaWRGb3JtID0gZmFsc2U7XG4gICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICB9O1xuICAgIH0odGhpcykpO1xuICAgIHJldHVybiB2YWxpZDtcbiAgfVxuICB2YWxpZGF0ZUZpZWxkKGZpZWxkKSB7XG4gICAgbGV0IG1zZ0JveCA9IGZpZWxkLnByZXZpb3VzRWxlbWVudFNpYmxpbmc7XG4gICAgaWYgKG1zZ0JveCA9PT0gbnVsbCkge1xuICAgICAgbXNnQm94ID0gZmllbGQucGFyZW50RWxlbWVudC5wcmV2aW91c0VsZW1lbnRTaWJsaW5nO1xuICAgIH1cbiAgICBpZiAoIGZpZWxkLmNoZWNrVmFsaWRpdHkoKSApIHtcbiAgICAgIGpRdWVyeShtc2dCb3gpLmhpZGUoKTtcbiAgICAgIHJldHVybiB0cnVlO1xuICAgIH0gZWxzZSB7XG4gICAgICBtc2dCb3guaW5uZXJIVE1MID0gZmllbGQudmFsaWRhdGlvbk1lc3NhZ2U7XG4gICAgICBqUXVlcnkobXNnQm94KS5zaG93KCk7XG4gICAgICByZXR1cm4gZmFsc2U7XG4gICAgfVxuICB9XG4gIGNhbGN1bGF0ZURpc3RhbmNlKHBsYWNlKSB7XG4gICAgbGV0IHNlbGYgPSB0aGlzO1xuICAgIGlmICh0eXBlb2YocGxhY2UpID09PSAndW5kZWZpbmVkJykge1xuICAgICAgc2VsZi5hZGRyZXNzTm90Rm91bmQodHJ1ZSk7XG4gICAgICByZXR1cm47XG4gICAgfTtcblxuICAgIGxldCBvcmlnaW4gPSAnSGF1cHRzdHJhc3NlIDk1LCAxNzE1IEFsdGVyc3dpbCwgU2Nod2Vpeic7XG4gICAgbGV0IGRlc3RpbmF0aW9uID0gbmV3IGdvb2dsZS5tYXBzLkxhdExuZyhwbGFjZS5nZW9tZXRyeS5sb2NhdGlvbi5sYXQoKSwgcGxhY2UuZ2VvbWV0cnkubG9jYXRpb24ubG5nKCkpO1xuICAgIGxldCBzZXJ2aWNlID0gbmV3IGdvb2dsZS5tYXBzLkRpc3RhbmNlTWF0cml4U2VydmljZSgpO1xuICAgIHNlcnZpY2UuZ2V0RGlzdGFuY2VNYXRyaXgoe1xuICAgICAgb3JpZ2luczogW29yaWdpbl0sXG4gICAgICBkZXN0aW5hdGlvbnM6IFtkZXN0aW5hdGlvbl0sXG4gICAgICB0cmF2ZWxNb2RlOiBnb29nbGUubWFwcy5UcmF2ZWxNb2RlLkRSSVZJTkcsfSxcbiAgICAgIGZ1bmN0aW9uKHJlc3BvbnNlLCBzdGF0dXMpIHtcbiAgICAgICAgaWYgKHN0YXR1cyA9PSBnb29nbGUubWFwcy5EaXN0YW5jZU1hdHJpeFN0YXR1cy5PSykge1xuICAgICAgICAgIGxldCBkaXN0YW5jZW1hdHJpeCA9IHJlc3BvbnNlLnJvd3NbMF0uZWxlbWVudHNbMF07XG4gICAgICAgICAgaWYgKGRpc3RhbmNlbWF0cml4LnN0YXR1cyA9PSBnb29nbGUubWFwcy5EaXN0YW5jZU1hdHJpeFN0YXR1cy5PSykge1xuICAgICAgICAgICAgc2VsZi5mb3JtLmV2ZW50bG9jYXRpb25kaXN0YW5jZShkaXN0YW5jZW1hdHJpeC5kaXN0YW5jZS52YWx1ZSk7XG4gICAgICAgICAgICBzZWxmLmFkZHJlc3NOb3RGb3VuZChmYWxzZSk7XG4gICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICB9XG4gICAgKTtcblxuICB9XG4gIGluaXRHb29nbGVTZWFyY2goKSB7XG4gICAgLy8gV2UgY2FsbCB0aGlzIGZ1bmNpdG9uIGZyb20gb3V0c2lkZS4gU28gd2UgaGF2ZSB0byBzZXQgXG4gICAgLy8gdGhlIHdpemFyZCBpdHNlbGYgdG8gYmUgYWJsZSB0byBhY2Nlc3MgaXRzIGZ1bmN0aW9ucy5cbiAgICBsZXQgc2VsZiA9IHdpbmRvdy53aXphcmQ7XG4gICAgalF1ZXJ5KHdpbmRvdykub24oJ2xvYWQnLCBmdW5jdGlvbigpIHtcbiAgICAgIHZhciBpbnB1dCA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdldmVudGxvY2F0aW9uJyk7XG4gICAgICB2YXIgc2VhcmNoQm94ID0gbmV3IGdvb2dsZS5tYXBzLnBsYWNlcy5TZWFyY2hCb3goaW5wdXQpO1xuICAgICAgc2VhcmNoQm94LmFkZExpc3RlbmVyKCdwbGFjZXNfY2hhbmdlZCcsIGZ1bmN0aW9uKCkge1xuICAgICAgICBzZWxmLmNhbGN1bGF0ZURpc3RhbmNlKHNlYXJjaEJveC5nZXRQbGFjZXMoKVswXSk7XG4gICAgICB9KTtcbiAgICAgIGdvb2dsZS5tYXBzLmV2ZW50LmFkZERvbUxpc3RlbmVyKGlucHV0LCAna2V5ZG93bicsIGZ1bmN0aW9uKGUpIHsgXG4gICAgICAgIGlmIChlLmtleUNvZGUgPT0gMTMpIHsgXG4gICAgICAgICAgICBlLnByZXZlbnREZWZhdWx0KCk7IFxuICAgICAgICB9XG4gICAgICB9KTsgXG4gICAgfSk7XG4gIH07XG59XG5cbndpbmRvdy53aXphcmQgPSBuZXcgV2l6YXJkKCk7XG52YXIgaW5pdEdvb2dsZVNlYXJjaCA9IHdpbmRvdy53aXphcmQuaW5pdEdvb2dsZVNlYXJjaDtcblxualF1ZXJ5KHdpbmRvdykub24oJ2xvYWQnLCBmdW5jdGlvbigpIHtcbiAga28uYXBwbHlCaW5kaW5ncyh3aW5kb3cud2l6YXJkLCBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnd2l6YXJkLWZvcm0nKSk7XG59KTtcbiJdfQ==
