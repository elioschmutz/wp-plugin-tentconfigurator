'use strict';

var _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if ("value" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();

function _possibleConstructorReturn(self, call) { if (!self) { throw new ReferenceError("this hasn't been initialised - super() hasn't been called"); } return call && (typeof call === "object" || typeof call === "function") ? call : self; }

function _inherits(subClass, superClass) { if (typeof superClass !== "function" && superClass !== null) { throw new TypeError("Super expression must either be null or a function, not " + typeof superClass); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, enumerable: false, writable: true, configurable: true } }); if (superClass) Object.setPrototypeOf ? Object.setPrototypeOf(subClass, superClass) : subClass.__proto__ = superClass; }

function _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError("Cannot call a class as a function"); } }

var Tent = function Tent(name, price, length, width, minPersons, maxPersons) {
  _classCallCheck(this, Tent);

  this.name = name;
  this.price = price;
  this.length = length;
  this.width = width;
  this.minPersons = minPersons;
  this.maxPersons = maxPersons;
  this.squareMeter = this.length * this.width;
};

var Equipment = function Equipment(title, price, description) {
  _classCallCheck(this, Equipment);

  this.title = title;
  this.price = price;
  this.description = description;
};

var tents = [new Tent('Zelttitel 1', 15, 4, 20, 100, 150), new Tent('Zelttitel 2', 30, 8, 20, 200, 300), new Tent('Zelttitel 3', 50, 12, 20, 150, 300)];

var equipments = [new Equipment('Lampe', 5, 'kleine Lampe für das DJ Pult'), new Equipment('Bodenplatte 30x30 cm', 2, 'Um den Boden zu schützen'), new Equipment('Tisch - 3 Meter ', 9, "für 6 Personen"), new Equipment('Tisch - 5 Meter ', 9, "für 9 Personen")];

var WizardStep = function () {
  function WizardStep() {
    var name = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : '';
    var wizardForm = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : null;

    _classCallCheck(this, WizardStep);

    this.name = name;
    this.active = ko.observable(false);
    this.activeSubStep = ko.observable();
    this.wizardForm = wizardForm;
    this.isVisible = ko.computed(function () {
      return this.active() && !this.activeSubStep();
    }, this);
  }

  _createClass(WizardStep, [{
    key: 'openSubStep',
    value: function openSubStep(substep) {
      substep.active(true);
      this.activeSubStep(substep);
    }
  }, {
    key: 'closeSubStep',
    value: function closeSubStep() {
      this.activeSubStep().active(false);
      this.activeSubStep(null);
    }
  }, {
    key: 'removeDataRow',
    value: function removeDataRow() {
      throw new Error('Override this function');
    }
  }]);

  return WizardStep;
}();

var WizardSubStep = function (_WizardStep) {
  _inherits(WizardSubStep, _WizardStep);

  function WizardSubStep(parent) {
    var _ref;

    _classCallCheck(this, WizardSubStep);

    for (var _len = arguments.length, args = Array(_len > 1 ? _len - 1 : 0), _key = 1; _key < _len; _key++) {
      args[_key - 1] = arguments[_key];
    }

    var _this = _possibleConstructorReturn(this, (_ref = WizardSubStep.__proto__ || Object.getPrototypeOf(WizardSubStep)).call.apply(_ref, [this].concat(args)));

    _this.parent = parent;
    _this.isVisible = ko.computed(function () {
      return this.active() && this.parent.active();
    }, _this);
    return _this;
  }

  return WizardSubStep;
}(WizardStep);

var WizardStepTents = function (_WizardStep2) {
  _inherits(WizardStepTents, _WizardStep2);

  function WizardStepTents() {
    var _ref2;

    _classCallCheck(this, WizardStepTents);

    for (var _len2 = arguments.length, args = Array(_len2), _key2 = 0; _key2 < _len2; _key2++) {
      args[_key2] = arguments[_key2];
    }

    var _this2 = _possibleConstructorReturn(this, (_ref2 = WizardStepTents.__proto__ || Object.getPrototypeOf(WizardStepTents)).call.apply(_ref2, [this].concat(args)));

    _this2.selectTentsSubStep = new WizardStepSelectTents(_this2);
    _this2.openSubStep(_this2.selectTentsSubStep);
    return _this2;
  }

  _createClass(WizardStepTents, [{
    key: 'openSelectTent',
    value: function openSelectTent() {
      this.openSubStep(this.selectTentsSubStep);
    }
  }, {
    key: 'removeDataRow',
    value: function removeDataRow(tent) {
      this.wizardForm.selectedTents.remove(tent);
    }
  }]);

  return WizardStepTents;
}(WizardStep);

var WizardStepEquipments = function (_WizardStep3) {
  _inherits(WizardStepEquipments, _WizardStep3);

  function WizardStepEquipments() {
    var _ref3;

    _classCallCheck(this, WizardStepEquipments);

    for (var _len3 = arguments.length, args = Array(_len3), _key3 = 0; _key3 < _len3; _key3++) {
      args[_key3] = arguments[_key3];
    }

    var _this3 = _possibleConstructorReturn(this, (_ref3 = WizardStepEquipments.__proto__ || Object.getPrototypeOf(WizardStepEquipments)).call.apply(_ref3, [this].concat(args)));

    _this3.selectEquipmentSubStep = new WizardStepSelectEquipment(_this3);
    _this3.openSubStep(_this3.selectEquipmentSubStep);
    return _this3;
  }

  _createClass(WizardStepEquipments, [{
    key: 'openSelectEquipment',
    value: function openSelectEquipment() {
      this.openSubStep(this.selectEquipmentSubStep);
    }
  }, {
    key: 'removeDataRow',
    value: function removeDataRow(equipment) {
      this.wizardForm.selectedEquipments.remove(equipment);
    }
  }]);

  return WizardStepEquipments;
}(WizardStep);

var WizardStepEvent = function (_WizardStep4) {
  _inherits(WizardStepEvent, _WizardStep4);

  function WizardStepEvent() {
    _classCallCheck(this, WizardStepEvent);

    return _possibleConstructorReturn(this, (WizardStepEvent.__proto__ || Object.getPrototypeOf(WizardStepEvent)).apply(this, arguments));
  }

  return WizardStepEvent;
}(WizardStep);

var WizardStepContact = function (_WizardStep5) {
  _inherits(WizardStepContact, _WizardStep5);

  function WizardStepContact() {
    var _ref4;

    _classCallCheck(this, WizardStepContact);

    for (var _len4 = arguments.length, args = Array(_len4), _key4 = 0; _key4 < _len4; _key4++) {
      args[_key4] = arguments[_key4];
    }

    var _this5 = _possibleConstructorReturn(this, (_ref4 = WizardStepContact.__proto__ || Object.getPrototypeOf(WizardStepContact)).call.apply(_ref4, [this].concat(args)));

    _this5.availableGenders = ko.observableArray(['', 'Herr', 'Frau']);
    return _this5;
  }

  return WizardStepContact;
}(WizardStep);

var WizardStepSelectTents = function (_WizardSubStep) {
  _inherits(WizardStepSelectTents, _WizardSubStep);

  function WizardStepSelectTents(parent) {
    var _ref5;

    _classCallCheck(this, WizardStepSelectTents);

    for (var _len5 = arguments.length, args = Array(_len5 > 1 ? _len5 - 1 : 0), _key5 = 1; _key5 < _len5; _key5++) {
      args[_key5 - 1] = arguments[_key5];
    }

    return _possibleConstructorReturn(this, (_ref5 = WizardStepSelectTents.__proto__ || Object.getPrototypeOf(WizardStepSelectTents)).call.apply(_ref5, [this, parent].concat(args)));
  }

  _createClass(WizardStepSelectTents, [{
    key: 'selectTent',
    value: function selectTent(tent) {
      this.parent.wizardForm.selectedTents.push(Object.assign(new Tent(), tent));
      this.parent.closeSubStep();
    }
  }]);

  return WizardStepSelectTents;
}(WizardSubStep);

var WizardStepSelectEquipment = function (_WizardSubStep2) {
  _inherits(WizardStepSelectEquipment, _WizardSubStep2);

  function WizardStepSelectEquipment() {
    _classCallCheck(this, WizardStepSelectEquipment);

    return _possibleConstructorReturn(this, (WizardStepSelectEquipment.__proto__ || Object.getPrototypeOf(WizardStepSelectEquipment)).apply(this, arguments));
  }

  _createClass(WizardStepSelectEquipment, [{
    key: 'selectEquipment',
    value: function selectEquipment(equipment) {
      this.parent.wizardForm.selectedEquipments.push(Object.assign(new Equipment(), equipment));
      this.parent.closeSubStep();
    }
  }]);

  return WizardStepSelectEquipment;
}(WizardSubStep);

var WizardForm = function () {
  function WizardForm() {
    _classCallCheck(this, WizardForm);

    this.firstName = ko.observable();
    this.lastName = ko.observable();
    this.salutation = ko.observable();
    this.company = ko.observable();
    this.street = ko.observable();
    this.streetnr = ko.observable();
    this.zip = ko.observable();
    this.location = ko.observable();
    this.email = ko.observable();
    this.phone = ko.observable();
    this.eventlocation = ko.observable();
    this.eventlocationdistance = ko.observable(0);

    this.tents = ko.observableArray(tents.sort(function (a, b) {
      return a.minPersons - b.minPersons;
    }));
    this.equipments = ko.observableArray(equipments);
    this.selectedTents = ko.observableArray();
    this.selectedEquipments = ko.observableArray();
    this.transportPrice = ko.computed(function () {
      if (this.eventlocationdistance() <= 10000) {
        return 0;
      } else {
        // 50.- each 30km * 2 (for twice the distance)
        return (Math.ceil(this.eventlocationdistance() / 1000 / 30) + 1) * 50 * 2;
      }
    }, this);
    this.totalTentsPrice = ko.computed(function () {
      return this._count_objs_attribute(this.selectedTents(), 'price');
    }, this);
    this.totalEquipmentsPrice = ko.computed(function () {
      return this._count_objs_attribute(this.selectedEquipments(), 'price');
    }, this);
    this.totalPrice = ko.computed(function () {
      return this.totalTentsPrice() + this.totalEquipmentsPrice() + this.transportPrice();
    }, this);
    this.totalMinPersons = ko.computed(function () {
      return this._count_objs_attribute(this.selectedTents(), 'minPersons');
    }, this);
    this.totalMaxPersons = ko.computed(function () {
      return this._count_objs_attribute(this.selectedTents(), 'maxPersons');
    }, this);
    this.totalSquareMeters = ko.computed(function () {
      return this._count_objs_attribute(this.selectedTents(), 'squareMeter');
    }, this);
  }

  _createClass(WizardForm, [{
    key: '_count_objs_attribute',
    value: function _count_objs_attribute(objs, attr) {
      var total = 0;
      objs.forEach(function (obj) {
        total += obj[attr];
      });
      return total;
    }
  }]);

  return WizardForm;
}();

var Wizard = function () {
  function Wizard() {
    _classCallCheck(this, Wizard);

    this.debug = false;
    if (typeof ajaxurl === 'undefined') {
      // wordpress sets the ajaxurl in the global scope.
      // If the ajaxurl is not initialized, we are not in a wordpress
      // environment.
      this.debug = true;
    }
    this.form = new WizardForm();
    // 0 = Fillout, 1 = Success, 2 = Error, 3 = pending, 4 = FormValidation error
    this.mode = ko.observable(0);
    this.steps = ko.observableArray([new WizardStepTents('Zelt', this.form), new WizardStepEquipments('Zubehör', this.form), new WizardStepEvent('Anlass', this.form), new WizardStepContact('Kontakt', this.form)]);
    this.currentStep = ko.observable(this.steps()[0]);
    this.showPrevButton = ko.computed(function () {
      return this.currentWizardStepId() > 0;
    }, this);
    this.showNextButton = ko.computed(function () {
      return this.currentWizardStepId() < this.steps().length - 1;
    }, this);
    this.showSendButton = ko.computed(function () {
      return this.currentWizardStepId() == this.steps().length - 1;
    }, this);
    ko.computed(function () {
      var _iteratorNormalCompletion = true;
      var _didIteratorError = false;
      var _iteratorError = undefined;

      try {
        for (var _iterator = this.steps()[Symbol.iterator](), _step; !(_iteratorNormalCompletion = (_step = _iterator.next()).done); _iteratorNormalCompletion = true) {
          var step = _step.value;

          step.active(false);
          if (this.currentStep() == step) {
            step.active(true);
          }
        }
      } catch (err) {
        _didIteratorError = true;
        _iteratorError = err;
      } finally {
        try {
          if (!_iteratorNormalCompletion && _iterator.return) {
            _iterator.return();
          }
        } finally {
          if (_didIteratorError) {
            throw _iteratorError;
          }
        }
      }
    }, this);

    jQuery(document).on('focusout', 'input[required], select[required]', function (self) {
      return function () {
        self.validateField(this);
      };
    }(this));
  }

  _createClass(Wizard, [{
    key: 'next',
    value: function next() {
      this.currentStep(this.steps()[this.currentWizardStepId() + 1]);
    }
  }, {
    key: 'previous',
    value: function previous() {
      this.currentStep(this.steps()[this.currentWizardStepId() - 1]);
    }
  }, {
    key: 'send',
    value: function send() {
      jQuery(window).scrollTop(0);
      if (!this.validateForm()) {
        this.mode(4);
        return;
      }
      this.mode(3);
      var self = this;
      var data = {
        action: 'kah_send_tent_configurator',
        firstName: this.form.firstName(),
        lastName: this.form.lastName(),
        salutation: this.form.salutation(),
        company: this.form.company(),
        street: this.form.street(),
        streetnr: this.form.streetnr(),
        zip: this.form.zip(),
        location: this.form.location(),
        email: this.form.email(),
        phone: this.form.phone(),
        selectedTents: this.form.selectedTents(),
        selectedEquipments: this.form.selectedEquipments(),
        totalTentsPrice: this.form.totalTentsPrice(),
        totalEquipmentsPrice: this.form.totalEquipmentsPrice(),
        totalPrice: this.form.totalPrice(),
        totalMinPersons: this.form.totalMinPersons(),
        totalMaxPersons: this.form.totalMaxPersons(),
        totalSquareMeters: this.form.totalSquareMeters()
      };
      var request = this._make_request(data);
      request.then(function () {
        self.mode(1);
      }, function () {
        self.mode(2);
      });
    }
  }, {
    key: 'readablePrice',
    value: function readablePrice(price) {
      return price + ' CHF';
    }
  }, {
    key: 'readablePersons',
    value: function readablePersons(minPersons, maxPersons) {
      return minPersons + ' - ' + maxPersons + ' Personen';
    }
  }, {
    key: 'currentWizardStepId',
    value: function currentWizardStepId() {
      return this.steps().indexOf(this.currentStep());
    }
  }, {
    key: '_make_request',
    value: function _make_request(data) {
      var self = this;
      return new Promise(function (resolve, reject) {

        if (self.debug) {
          window.setTimeout(function () {
            resolve();
          }, 2000);
        } else {
          jQuery.post(ajaxurl, data).done(function () {
            resolve();
          }).fail(function () {
            reject();
          });
        }
      });
    }
  }, {
    key: 'validateForm',
    value: function validateForm() {
      var valid = true;
      $('input[required], select[required]').each(function (self) {
        return function (counter, field) {
          if (!self.validateField(field)) {
            valid = false;
          }
        };
      }(this));
      return valid;
    }
  }, {
    key: 'validateField',
    value: function validateField(field) {
      var msgBox = field.previousElementSibling;
      if (field.checkValidity()) {
        $(msgBox).hide();
        return true;
      } else {
        msgBox.innerHTML = field.validationMessage;
        $(msgBox).show();
        return false;
      }
    }
  }, {
    key: 'calculateDistance',
    value: function calculateDistance(place) {
      var self = this;
      console.log(self);

      var origin = 'Hauptstrasse 95, 1715 Alterswil, Schweiz';
      var destination = new google.maps.LatLng(place.geometry.location.lat(), place.geometry.location.lng());
      var service = new google.maps.DistanceMatrixService();
      service.getDistanceMatrix({
        origins: [origin],
        destinations: [destination],
        travelMode: google.maps.TravelMode.DRIVING }, function (response, status) {
        if (status == google.maps.DistanceMatrixStatus.OK) {
          var distancematrix = response.rows[0].elements[0];
          if (distancematrix.status == google.maps.DistanceMatrixStatus.OK) {
            self.form.eventlocationdistance(distancematrix.distance.value);
          }
        }
      });
    }
  }, {
    key: 'initGoogleSearch',
    value: function initGoogleSearch() {
      // We call this funciton from outside. So we have to set 
      // the wizard itself to be able to access its functions.
      var self = window.wizard;
      jQuery(window).on('load', function () {
        var input = document.getElementById('eventlocation');
        var searchBox = new google.maps.places.SearchBox(input);
        searchBox.addListener('places_changed', function () {
          self.calculateDistance(searchBox.getPlaces()[0]);
        });
      });
    }
  }]);

  return Wizard;
}();

window.wizard = new Wizard();
var initGoogleSearch = window.wizard.initGoogleSearch;

jQuery(window).on('load', function () {
  ko.applyBindings(window.wizard, document.getElementById('wizard-form'));
});
//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIm1haW4uanMiXSwibmFtZXMiOlsiVGVudCIsIm5hbWUiLCJwcmljZSIsImxlbmd0aCIsIndpZHRoIiwibWluUGVyc29ucyIsIm1heFBlcnNvbnMiLCJzcXVhcmVNZXRlciIsIkVxdWlwbWVudCIsInRpdGxlIiwiZGVzY3JpcHRpb24iLCJ0ZW50cyIsImVxdWlwbWVudHMiLCJXaXphcmRTdGVwIiwid2l6YXJkRm9ybSIsImFjdGl2ZSIsImtvIiwib2JzZXJ2YWJsZSIsImFjdGl2ZVN1YlN0ZXAiLCJpc1Zpc2libGUiLCJjb21wdXRlZCIsInN1YnN0ZXAiLCJFcnJvciIsIldpemFyZFN1YlN0ZXAiLCJwYXJlbnQiLCJhcmdzIiwiV2l6YXJkU3RlcFRlbnRzIiwic2VsZWN0VGVudHNTdWJTdGVwIiwiV2l6YXJkU3RlcFNlbGVjdFRlbnRzIiwib3BlblN1YlN0ZXAiLCJ0ZW50Iiwic2VsZWN0ZWRUZW50cyIsInJlbW92ZSIsIldpemFyZFN0ZXBFcXVpcG1lbnRzIiwic2VsZWN0RXF1aXBtZW50U3ViU3RlcCIsIldpemFyZFN0ZXBTZWxlY3RFcXVpcG1lbnQiLCJlcXVpcG1lbnQiLCJzZWxlY3RlZEVxdWlwbWVudHMiLCJXaXphcmRTdGVwRXZlbnQiLCJXaXphcmRTdGVwQ29udGFjdCIsImF2YWlsYWJsZUdlbmRlcnMiLCJvYnNlcnZhYmxlQXJyYXkiLCJwdXNoIiwiT2JqZWN0IiwiYXNzaWduIiwiY2xvc2VTdWJTdGVwIiwiV2l6YXJkRm9ybSIsImZpcnN0TmFtZSIsImxhc3ROYW1lIiwic2FsdXRhdGlvbiIsImNvbXBhbnkiLCJzdHJlZXQiLCJzdHJlZXRuciIsInppcCIsImxvY2F0aW9uIiwiZW1haWwiLCJwaG9uZSIsImV2ZW50bG9jYXRpb24iLCJldmVudGxvY2F0aW9uZGlzdGFuY2UiLCJzb3J0IiwiYSIsImIiLCJ0cmFuc3BvcnRQcmljZSIsIk1hdGgiLCJjZWlsIiwidG90YWxUZW50c1ByaWNlIiwiX2NvdW50X29ianNfYXR0cmlidXRlIiwidG90YWxFcXVpcG1lbnRzUHJpY2UiLCJ0b3RhbFByaWNlIiwidG90YWxNaW5QZXJzb25zIiwidG90YWxNYXhQZXJzb25zIiwidG90YWxTcXVhcmVNZXRlcnMiLCJvYmpzIiwiYXR0ciIsInRvdGFsIiwiZm9yRWFjaCIsIm9iaiIsIldpemFyZCIsImRlYnVnIiwiYWpheHVybCIsImZvcm0iLCJtb2RlIiwic3RlcHMiLCJjdXJyZW50U3RlcCIsInNob3dQcmV2QnV0dG9uIiwiY3VycmVudFdpemFyZFN0ZXBJZCIsInNob3dOZXh0QnV0dG9uIiwic2hvd1NlbmRCdXR0b24iLCJzdGVwIiwialF1ZXJ5IiwiZG9jdW1lbnQiLCJvbiIsInNlbGYiLCJ2YWxpZGF0ZUZpZWxkIiwid2luZG93Iiwic2Nyb2xsVG9wIiwidmFsaWRhdGVGb3JtIiwiZGF0YSIsImFjdGlvbiIsInJlcXVlc3QiLCJfbWFrZV9yZXF1ZXN0IiwidGhlbiIsImluZGV4T2YiLCJQcm9taXNlIiwicmVzb2x2ZSIsInJlamVjdCIsInNldFRpbWVvdXQiLCJwb3N0IiwiZG9uZSIsImZhaWwiLCJ2YWxpZCIsIiQiLCJlYWNoIiwiY291bnRlciIsImZpZWxkIiwibXNnQm94IiwicHJldmlvdXNFbGVtZW50U2libGluZyIsImNoZWNrVmFsaWRpdHkiLCJoaWRlIiwiaW5uZXJIVE1MIiwidmFsaWRhdGlvbk1lc3NhZ2UiLCJzaG93IiwicGxhY2UiLCJjb25zb2xlIiwibG9nIiwib3JpZ2luIiwiZGVzdGluYXRpb24iLCJnb29nbGUiLCJtYXBzIiwiTGF0TG5nIiwiZ2VvbWV0cnkiLCJsYXQiLCJsbmciLCJzZXJ2aWNlIiwiRGlzdGFuY2VNYXRyaXhTZXJ2aWNlIiwiZ2V0RGlzdGFuY2VNYXRyaXgiLCJvcmlnaW5zIiwiZGVzdGluYXRpb25zIiwidHJhdmVsTW9kZSIsIlRyYXZlbE1vZGUiLCJEUklWSU5HIiwicmVzcG9uc2UiLCJzdGF0dXMiLCJEaXN0YW5jZU1hdHJpeFN0YXR1cyIsIk9LIiwiZGlzdGFuY2VtYXRyaXgiLCJyb3dzIiwiZWxlbWVudHMiLCJkaXN0YW5jZSIsInZhbHVlIiwid2l6YXJkIiwiaW5wdXQiLCJnZXRFbGVtZW50QnlJZCIsInNlYXJjaEJveCIsInBsYWNlcyIsIlNlYXJjaEJveCIsImFkZExpc3RlbmVyIiwiY2FsY3VsYXRlRGlzdGFuY2UiLCJnZXRQbGFjZXMiLCJpbml0R29vZ2xlU2VhcmNoIiwiYXBwbHlCaW5kaW5ncyJdLCJtYXBwaW5ncyI6Ijs7Ozs7Ozs7OztJQUFNQSxPQUNKLGNBQVlDLElBQVosRUFBa0JDLEtBQWxCLEVBQXlCQyxNQUF6QixFQUFpQ0MsS0FBakMsRUFBd0NDLFVBQXhDLEVBQW9EQyxVQUFwRCxFQUFnRTtBQUFBOztBQUM5RCxPQUFLTCxJQUFMLEdBQVlBLElBQVo7QUFDQSxPQUFLQyxLQUFMLEdBQWFBLEtBQWI7QUFDQSxPQUFLQyxNQUFMLEdBQWNBLE1BQWQ7QUFDQSxPQUFLQyxLQUFMLEdBQWFBLEtBQWI7QUFDQSxPQUFLQyxVQUFMLEdBQWtCQSxVQUFsQjtBQUNBLE9BQUtDLFVBQUwsR0FBa0JBLFVBQWxCO0FBQ0EsT0FBS0MsV0FBTCxHQUFtQixLQUFLSixNQUFMLEdBQWMsS0FBS0MsS0FBdEM7QUFDRDs7SUFHR0ksWUFDSixtQkFBWUMsS0FBWixFQUFtQlAsS0FBbkIsRUFBMEJRLFdBQTFCLEVBQXVDO0FBQUE7O0FBQ3JDLE9BQUtELEtBQUwsR0FBYUEsS0FBYjtBQUNBLE9BQUtQLEtBQUwsR0FBYUEsS0FBYjtBQUNBLE9BQUtRLFdBQUwsR0FBbUJBLFdBQW5CO0FBQ0Q7O0FBR0gsSUFBSUMsUUFBUSxDQUNWLElBQUlYLElBQUosQ0FBUyxhQUFULEVBQXdCLEVBQXhCLEVBQTRCLENBQTVCLEVBQStCLEVBQS9CLEVBQW1DLEdBQW5DLEVBQXdDLEdBQXhDLENBRFUsRUFFVixJQUFJQSxJQUFKLENBQVMsYUFBVCxFQUF3QixFQUF4QixFQUE0QixDQUE1QixFQUErQixFQUEvQixFQUFtQyxHQUFuQyxFQUF3QyxHQUF4QyxDQUZVLEVBR1YsSUFBSUEsSUFBSixDQUFTLGFBQVQsRUFBd0IsRUFBeEIsRUFB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RyxRQUFmLENBQXdCQyxLQUF4RDtBQUNEO0FBQ0Y7QUFDRixPQVhIO0FBY0Q7Ozt1Q0FDa0I7QUFDakI7QUFDQTtBQUNBLFVBQUl6RCxPQUFPRSxPQUFPd0QsTUFBbEI7QUFDQTdELGFBQU9LLE1BQVAsRUFBZUgsRUFBZixDQUFrQixNQUFsQixFQUEwQixZQUFXO0FBQ25DLFlBQUk0RCxRQUFRN0QsU0FBUzhELGNBQVQsQ0FBd0IsZUFBeEIsQ0FBWjtBQUNBLFlBQUlDLFlBQVksSUFBSTFCLE9BQU9DLElBQVAsQ0FBWTBCLE1BQVosQ0FBbUJDLFNBQXZCLENBQWlDSixLQUFqQyxDQUFoQjtBQUNBRSxrQkFBVUcsV0FBVixDQUFzQixnQkFBdEIsRUFBd0MsWUFBVztBQUNqRGhFLGVBQUtpRSxpQkFBTCxDQUF1QkosVUFBVUssU0FBVixHQUFzQixDQUF0QixDQUF2QjtBQUNELFNBRkQ7QUFHRCxPQU5EO0FBT0Q7Ozs7OztBQUdIaEUsT0FBT3dELE1BQVAsR0FBZ0IsSUFBSXpFLE1BQUosRUFBaEI7QUFDQSxJQUFJa0YsbUJBQW1CakUsT0FBT3dELE1BQVAsQ0FBY1MsZ0JBQXJDOztBQUVBdEUsT0FBT0ssTUFBUCxFQUFlSCxFQUFmLENBQWtCLE1BQWxCLEVBQTBCLFlBQVc7QUFDbkMzRSxLQUFHZ0osYUFBSCxDQUFpQmxFLE9BQU93RCxNQUF4QixFQUFnQzVELFNBQVM4RCxjQUFULENBQXdCLGFBQXhCLENBQWhDO0FBQ0QsQ0FGRCIsImZpbGUiOiJhbGwubWluLmpzIiwic291cmNlc0NvbnRlbnQiOlsiY2xhc3MgVGVudCB7XG4gIGNvbnN0cnVjdG9yKG5hbWUsIHByaWNlLCBsZW5ndGgsIHdpZHRoLCBtaW5QZXJzb25zLCBtYXhQZXJzb25zKSB7XG4gICAgdGhpcy5uYW1lID0gbmFtZTtcbiAgICB0aGlzLnByaWNlID0gcHJpY2U7XG4gICAgdGhpcy5sZW5ndGggPSBsZW5ndGg7XG4gICAgdGhpcy53aWR0aCA9IHdpZHRoO1xuICAgIHRoaXMubWluUGVyc29ucyA9IG1pblBlcnNvbnM7XG4gICAgdGhpcy5tYXhQZXJzb25zID0gbWF4UGVyc29ucztcbiAgICB0aGlzLnNxdWFyZU1ldGVyID0gdGhpcy5sZW5ndGggKiB0aGlzLndpZHRoO1xuICB9XG59XG5cbmNsYXNzIEVxdWlwbWVudCB7XG4gIGNvbnN0cnVjdG9yKHRpdGxlLCBwcmljZSwgZGVzY3JpcHRpb24pIHtcbiAgICB0aGlzLnRpdGxlID0gdGl0bGU7XG4gICAgdGhpcy5wcmljZSA9IHByaWNlOyBcbiAgICB0aGlzLmRlc2NyaXB0aW9uID0gZGVzY3JpcHRpb247XG4gIH1cbn1cblxudmFyIHRlbnRzID0gW1xuICBuZXcgVGVudCgnWmVsdHRpdGVsIDEnLCAxNSwgNCwgMjAsIDEwMCwgMTUwKSxcbiAgbmV3IFRlbnQoJ1plbHR0aXRlbCAyJywgMzAsIDgsIDIwLCAyMDAsIDMwMCksXG4gIG5ldyBUZW50KCdaZWx0dGl0ZWwgMycsIDUwLCAxMiwgMjAsIDE1MCwgMzAwKSxcbl07XG5cbnZhciBlcXVpcG1lbnRzID0gW1xuICBuZXcgRXF1aXBtZW50KCdMYW1wZScsIDUsICdrbGVpbmUgTGFtcGUgZsO8ciBkYXMgREogUHVsdCcpLFxuICBuZXcgRXF1aXBtZW50KCdCb2RlbnBsYXR0ZSAzMHgzMCBjbScsIDIsICdVbSBkZW4gQm9kZW4genUgc2Now7x0emVuJyksXG4gIG5ldyBFcXVpcG1lbnQoJ1Rpc2NoIC0gMyBNZXRlciAnLCA5LCBcImbDvHIgNiBQZXJzb25lblwiKSxcbiAgbmV3IEVxdWlwbWVudCgnVGlzY2ggLSA1IE1ldGVyICcsIDksIFwiZsO8ciA5IFBlcnNvbmVuXCIpXG5dO1xuXG5jbGFzcyBXaXphcmRTdGVwIHtcbiAgY29uc3RydWN0b3IobmFtZT0nJywgd2l6YXJkRm9ybT1udWxsKSB7XG4gICAgdGhpcy5uYW1lID0gbmFtZTtcbiAgICB0aGlzLmFjdGl2ZSA9IGtvLm9ic2VydmFibGUoZmFsc2UpO1xuICAgIHRoaXMuYWN0aXZlU3ViU3RlcCA9IGtvLm9ic2VydmFibGUoKTtcbiAgICB0aGlzLndpemFyZEZvcm0gPSB3aXphcmRGb3JtO1xuICAgIHRoaXMuaXNWaXNpYmxlID0ga28uY29tcHV0ZWQoZnVuY3Rpb24oKSB7XG4gICAgICByZXR1cm4gdGhpcy5hY3RpdmUoKSAmJiAhdGhpcy5hY3RpdmVTdWJTdGVwKCk7XG4gICAgfSwgdGhpcyk7XG4gIH1cbiAgb3BlblN1YlN0ZXAoc3Vic3RlcCkge1xuICAgIHN1YnN0ZXAuYWN0aXZlKHRydWUpO1xuICAgIHRoaXMuYWN0aXZlU3ViU3RlcChzdWJzdGVwKTtcbiAgfVxuICBjbG9zZVN1YlN0ZXAoKSB7XG4gICAgdGhpcy5hY3RpdmVTdWJTdGVwKCkuYWN0aXZlKGZhbHNlKTtcbiAgICB0aGlzLmFjdGl2ZVN1YlN0ZXAobnVsbCk7XG4gIH1cbiAgcmVtb3ZlRGF0YVJvdygpIHsgdGhyb3cgbmV3IEVycm9yKCdPdmVycmlkZSB0aGlzIGZ1bmN0aW9uJyk7IH1cbn1cblxuY2xhc3MgV2l6YXJkU3ViU3RlcCBleHRlbmRzIFdpemFyZFN0ZXAge1xuICBjb25zdHJ1Y3RvcihwYXJlbnQsIC4uLmFyZ3MpIHtcbiAgICBzdXBlciguLi5hcmdzKTtcbiAgICB0aGlzLnBhcmVudCA9IHBhcmVudDtcbiAgICB0aGlzLmlzVmlzaWJsZSA9IGtvLmNvbXB1dGVkKGZ1bmN0aW9uKCkge1xuICAgICAgcmV0dXJuIHRoaXMuYWN0aXZlKCkgJiYgdGhpcy5wYXJlbnQuYWN0aXZlKCk7XG4gICAgfSwgdGhpcyk7XG4gIH1cbn1cbmNsYXNzIFdpemFyZFN0ZXBUZW50cyBleHRlbmRzIFdpemFyZFN0ZXAge1xuICBjb25zdHJ1Y3RvciguLi5hcmdzKSB7XG4gICAgc3VwZXIoLi4uYXJncyk7XG4gICAgdGhpcy5zZWxlY3RUZW50c1N1YlN0ZXAgPSBuZXcgV2l6YXJkU3RlcFNlbGVjdFRlbnRzKHRoaXMpO1xuICAgIHRoaXMub3BlblN1YlN0ZXAodGhpcy5zZWxlY3RUZW50c1N1YlN0ZXApO1xuICB9XG4gIG9wZW5TZWxlY3RUZW50KCkge1xuICAgIHRoaXMub3BlblN1YlN0ZXAodGhpcy5zZWxlY3RUZW50c1N1YlN0ZXApO1xuICB9XG4gIHJlbW92ZURhdGFSb3codGVudCkge1xuICAgIHRoaXMud2l6YXJkRm9ybS5zZWxlY3RlZFRlbnRzLnJlbW92ZSh0ZW50KTtcbiAgfVxufVxuXG5jbGFzcyBXaXphcmRTdGVwRXF1aXBtZW50cyBleHRlbmRzIFdpemFyZFN0ZXAge1xuICBjb25zdHJ1Y3RvciguLi5hcmdzKSB7XG4gICAgc3VwZXIoLi4uYXJncyk7XG4gICAgdGhpcy5zZWxlY3RFcXVpcG1lbnRTdWJTdGVwID0gbmV3IFdpemFyZFN0ZXBTZWxlY3RFcXVpcG1lbnQodGhpcyk7XG4gICAgdGhpcy5vcGVuU3ViU3RlcCh0aGlzLnNlbGVjdEVxdWlwbWVudFN1YlN0ZXApO1xuICB9XG4gIG9wZW5TZWxlY3RFcXVpcG1lbnQoKSB7XG4gICAgdGhpcy5vcGVuU3ViU3RlcCh0aGlzLnNlbGVjdEVxdWlwbWVudFN1YlN0ZXApO1xuICB9XG4gIHJlbW92ZURhdGFSb3coZXF1aXBtZW50KSB7XG4gICAgdGhpcy53aXphcmRGb3JtLnNlbGVjdGVkRXF1aXBtZW50cy5yZW1vdmUoZXF1aXBtZW50KTtcbiAgfSBcbn1cblxuY2xhc3MgV2l6YXJkU3RlcEV2ZW50IGV4dGVuZHMgV2l6YXJkU3RlcCB7XG59XG5cblxuY2xhc3MgV2l6YXJkU3RlcENvbnRhY3QgZXh0ZW5kcyBXaXphcmRTdGVwIHtcbiAgY29uc3RydWN0b3IoLi4uYXJncykge1xuICAgIHN1cGVyKC4uLmFyZ3MpO1xuICAgIHRoaXMuYXZhaWxhYmxlR2VuZGVycyA9IGtvLm9ic2VydmFibGVBcnJheShbJycsICdIZXJyJywgJ0ZyYXUnXSk7XG4gIH1cbn1cblxuY2xhc3MgV2l6YXJkU3RlcFNlbGVjdFRlbnRzIGV4dGVuZHMgV2l6YXJkU3ViU3RlcCB7XG4gIGNvbnN0cnVjdG9yKHBhcmVudCwgLi4uYXJncykge1xuICAgIHN1cGVyKHBhcmVudCwgLi4uYXJncyk7XG4gIH1cbiAgc2VsZWN0VGVudCh0ZW50KSB7XG4gICAgdGhpcy5wYXJlbnQud2l6YXJkRm9ybS5zZWxlY3RlZFRlbnRzLnB1c2goT2JqZWN0LmFzc2lnbihuZXcgVGVudCgpLCB0ZW50KSk7XG4gICAgdGhpcy5wYXJlbnQuY2xvc2VTdWJTdGVwKCk7XG4gIH1cbn1cblxuY2xhc3MgV2l6YXJkU3RlcFNlbGVjdEVxdWlwbWVudCBleHRlbmRzIFdpemFyZFN1YlN0ZXAge1xuICBzZWxlY3RFcXVpcG1lbnQoZXF1aXBtZW50KSB7XG4gICAgdGhpcy5wYXJlbnQud2l6YXJkRm9ybS5zZWxlY3RlZEVxdWlwbWVudHMucHVzaChPYmplY3QuYXNzaWduKG5ldyBFcXVpcG1lbnQoKSwgZXF1aXBtZW50KSk7XG4gICAgdGhpcy5wYXJlbnQuY2xvc2VTdWJTdGVwKCk7XG4gIH1cbn1cbmNsYXNzIFdpemFyZEZvcm0ge1xuICBjb25zdHJ1Y3RvcigpIHtcbiAgICB0aGlzLmZpcnN0TmFtZSA9IGtvLm9ic2VydmFibGUoKTtcbiAgICB0aGlzLmxhc3ROYW1lID0ga28ub2JzZXJ2YWJsZSgpO1xuICAgIHRoaXMuc2FsdXRhdGlvbiA9IGtvLm9ic2VydmFibGUoKTtcbiAgICB0aGlzLmNvbXBhbnkgPSBrby5vYnNlcnZhYmxlKCk7XG4gICAgdGhpcy5zdHJlZXQgPSBrby5vYnNlcnZhYmxlKCk7XG4gICAgdGhpcy5zdHJlZXRuciA9IGtvLm9ic2VydmFibGUoKTtcbiAgICB0aGlzLnppcCA9IGtvLm9ic2VydmFibGUoKTtcbiAgICB0aGlzLmxvY2F0aW9uID0ga28ub2JzZXJ2YWJsZSgpO1xuICAgIHRoaXMuZW1haWwgPSBrby5vYnNlcnZhYmxlKCk7XG4gICAgdGhpcy5waG9uZSA9IGtvLm9ic2VydmFibGUoKTtcbiAgICB0aGlzLmV2ZW50bG9jYXRpb24gPSBrby5vYnNlcnZhYmxlKCk7XG4gICAgdGhpcy5ldmVudGxvY2F0aW9uZGlzdGFuY2UgPSBrby5vYnNlcnZhYmxlKDApO1xuXG4gICAgdGhpcy50ZW50cyA9IGtvLm9ic2VydmFibGVBcnJheSh0ZW50cy5zb3J0KChhLCBiKSA9PiBhLm1pblBlcnNvbnMgLSBiLm1pblBlcnNvbnMpKTtcbiAgICB0aGlzLmVxdWlwbWVudHMgPSBrby5vYnNlcnZhYmxlQXJyYXkoZXF1aXBtZW50cyk7XG4gICAgdGhpcy5zZWxlY3RlZFRlbnRzID0ga28ub2JzZXJ2YWJsZUFycmF5KCk7XG4gICAgdGhpcy5zZWxlY3RlZEVxdWlwbWVudHMgPSBrby5vYnNlcnZhYmxlQXJyYXkoKTtcbiAgICB0aGlzLnRyYW5zcG9ydFByaWNlID0ga28uY29tcHV0ZWQoZnVuY3Rpb24oKSB7XG4gICAgICBpZiAoIHRoaXMuZXZlbnRsb2NhdGlvbmRpc3RhbmNlKCkgPD0gMTAwMDAgKSB7XG4gICAgICAgIHJldHVybiAwO1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgLy8gNTAuLSBlYWNoIDMwa20gKiAyIChmb3IgdHdpY2UgdGhlIGRpc3RhbmNlKVxuICAgICAgICByZXR1cm4gKE1hdGguY2VpbCh0aGlzLmV2ZW50bG9jYXRpb25kaXN0YW5jZSgpIC8gMTAwMCAvIDMwKSArIDEpICogNTAgKiAyO1xuICAgICAgfVxuICAgIH0sIHRoaXMpO1xuICAgIHRoaXMudG90YWxUZW50c1ByaWNlID0ga28uY29tcHV0ZWQoZnVuY3Rpb24oKSB7XG4gICAgICByZXR1cm4gdGhpcy5fY291bnRfb2Jqc19hdHRyaWJ1dGUodGhpcy5zZWxlY3RlZFRlbnRzKCksICdwcmljZScpO1xuICAgIH0sIHRoaXMpO1xuICAgIHRoaXMudG90YWxFcXVpcG1lbnRzUHJpY2UgPSBrby5jb21wdXRlZChmdW5jdGlvbigpIHtcbiAgICAgIHJldHVybiB0aGlzLl9jb3VudF9vYmpzX2F0dHJpYnV0ZSh0aGlzLnNlbGVjdGVkRXF1aXBtZW50cygpLCAncHJpY2UnKTtcbiAgICB9LCB0aGlzKTtcbiAgICB0aGlzLnRvdGFsUHJpY2UgPSBrby5jb21wdXRlZChmdW5jdGlvbigpIHtcbiAgICAgIHJldHVybiB0aGlzLnRvdGFsVGVudHNQcmljZSgpICsgdGhpcy50b3RhbEVxdWlwbWVudHNQcmljZSgpICsgdGhpcy50cmFuc3BvcnRQcmljZSgpO1xuICAgIH0sIHRoaXMpO1xuICAgIHRoaXMudG90YWxNaW5QZXJzb25zID0ga28uY29tcHV0ZWQoZnVuY3Rpb24oKSB7XG4gICAgICByZXR1cm4gdGhpcy5fY291bnRfb2Jqc19hdHRyaWJ1dGUodGhpcy5zZWxlY3RlZFRlbnRzKCksICdtaW5QZXJzb25zJyk7XG4gICAgfSwgdGhpcyk7XG4gICAgdGhpcy50b3RhbE1heFBlcnNvbnMgPSBrby5jb21wdXRlZChmdW5jdGlvbigpIHtcbiAgICAgIHJldHVybiB0aGlzLl9jb3VudF9vYmpzX2F0dHJpYnV0ZSh0aGlzLnNlbGVjdGVkVGVudHMoKSwgJ21heFBlcnNvbnMnKTtcbiAgICB9LCB0aGlzKTtcbiAgICB0aGlzLnRvdGFsU3F1YXJlTWV0ZXJzID0ga28uY29tcHV0ZWQoZnVuY3Rpb24oKSB7XG4gICAgICByZXR1cm4gdGhpcy5fY291bnRfb2Jqc19hdHRyaWJ1dGUodGhpcy5zZWxlY3RlZFRlbnRzKCksICdzcXVhcmVNZXRlcicpO1xuICAgIH0sIHRoaXMpO1xuICB9XG4gIF9jb3VudF9vYmpzX2F0dHJpYnV0ZShvYmpzLCBhdHRyKSB7XG4gICAgbGV0IHRvdGFsID0gMDtcbiAgICBvYmpzLmZvckVhY2goZnVuY3Rpb24ob2JqKSB7IHRvdGFsICs9IG9ialthdHRyXTsgfSk7XG4gICAgcmV0dXJuIHRvdGFsO1xuICB9XG59XG5cbmNsYXNzIFdpemFyZCB7XG4gIGNvbnN0cnVjdG9yKCkge1xuICAgIHRoaXMuZGVidWcgPSBmYWxzZTtcbiAgICBpZiAodHlwZW9mIGFqYXh1cmwgPT09ICd1bmRlZmluZWQnICkge1xuICAgICAgLy8gd29yZHByZXNzIHNldHMgdGhlIGFqYXh1cmwgaW4gdGhlIGdsb2JhbCBzY29wZS5cbiAgICAgIC8vIElmIHRoZSBhamF4dXJsIGlzIG5vdCBpbml0aWFsaXplZCwgd2UgYXJlIG5vdCBpbiBhIHdvcmRwcmVzc1xuICAgICAgLy8gZW52aXJvbm1lbnQuXG4gICAgICB0aGlzLmRlYnVnID0gdHJ1ZTtcbiAgICB9XG4gICAgdGhpcy5mb3JtID0gbmV3IFdpemFyZEZvcm0oKTtcbiAgICAvLyAwID0gRmlsbG91dCwgMSA9IFN1Y2Nlc3MsIDIgPSBFcnJvciwgMyA9IHBlbmRpbmcsIDQgPSBGb3JtVmFsaWRhdGlvbiBlcnJvclxuICAgIHRoaXMubW9kZSA9IGtvLm9ic2VydmFibGUoMCk7XG4gICAgdGhpcy5zdGVwcyA9IGtvLm9ic2VydmFibGVBcnJheShbXG4gICAgICBuZXcgV2l6YXJkU3RlcFRlbnRzKCdaZWx0JywgdGhpcy5mb3JtKSxcbiAgICAgIG5ldyBXaXphcmRTdGVwRXF1aXBtZW50cygnWnViZWjDtnInLCB0aGlzLmZvcm0pLFxuICAgICAgbmV3IFdpemFyZFN0ZXBFdmVudCgnQW5sYXNzJywgdGhpcy5mb3JtKSxcbiAgICAgIG5ldyBXaXphcmRTdGVwQ29udGFjdCgnS29udGFrdCcsIHRoaXMuZm9ybSlcbiAgICBdKTtcbiAgICB0aGlzLmN1cnJlbnRTdGVwID0ga28ub2JzZXJ2YWJsZSh0aGlzLnN0ZXBzKClbMF0pO1xuICAgIHRoaXMuc2hvd1ByZXZCdXR0b24gPSBrby5jb21wdXRlZChmdW5jdGlvbigpIHtcbiAgICAgIHJldHVybiB0aGlzLmN1cnJlbnRXaXphcmRTdGVwSWQoKSA+IDA7XG4gICAgfSwgdGhpcyk7XG4gICAgdGhpcy5zaG93TmV4dEJ1dHRvbiA9IGtvLmNvbXB1dGVkKGZ1bmN0aW9uKCkge1xuICAgICAgcmV0dXJuIHRoaXMuY3VycmVudFdpemFyZFN0ZXBJZCgpIDwgKHRoaXMuc3RlcHMoKS5sZW5ndGggLTEpO1xuICAgIH0sIHRoaXMpO1xuICAgIHRoaXMuc2hvd1NlbmRCdXR0b24gPSBrby5jb21wdXRlZChmdW5jdGlvbigpIHtcbiAgICAgIHJldHVybiB0aGlzLmN1cnJlbnRXaXphcmRTdGVwSWQoKSA9PSB0aGlzLnN0ZXBzKCkubGVuZ3RoIC0xO1xuICAgIH0sIHRoaXMpO1xuICAgIGtvLmNvbXB1dGVkKGZ1bmN0aW9uKCkge1xuICAgICAgZm9yIChsZXQgc3RlcCBvZiB0aGlzLnN0ZXBzKCkpIHtcbiAgICAgICAgc3RlcC5hY3RpdmUoZmFsc2UpO1xuICAgICAgICBpZiAoIHRoaXMuY3VycmVudFN0ZXAoKSA9PSBzdGVwICkge1xuICAgICAgICAgIHN0ZXAuYWN0aXZlKHRydWUpO1xuICAgICAgICB9XG4gICAgICB9XG4gICAgfSwgdGhpcyk7XG5cbiAgICBqUXVlcnkoZG9jdW1lbnQpLm9uKCdmb2N1c291dCcsICdpbnB1dFtyZXF1aXJlZF0sIHNlbGVjdFtyZXF1aXJlZF0nLCBmdW5jdGlvbihzZWxmKSB7XG4gICAgICByZXR1cm4gZnVuY3Rpb24oKSB7XG4gICAgICAgIHNlbGYudmFsaWRhdGVGaWVsZCh0aGlzKTtcbiAgICAgIH07XG4gICAgfSh0aGlzKSk7XG4gIH1cbiAgbmV4dCgpIHtcbiAgICB0aGlzLmN1cnJlbnRTdGVwKHRoaXMuc3RlcHMoKVt0aGlzLmN1cnJlbnRXaXphcmRTdGVwSWQoKSArIDFdKTtcbiAgfVxuICBwcmV2aW91cygpIHtcbiAgICB0aGlzLmN1cnJlbnRTdGVwKHRoaXMuc3RlcHMoKVt0aGlzLmN1cnJlbnRXaXphcmRTdGVwSWQoKSAtMV0pO1xuICB9XG4gIHNlbmQoKSB7XG4gICAgalF1ZXJ5KHdpbmRvdykuc2Nyb2xsVG9wKDApO1xuICAgIGlmICggIXRoaXMudmFsaWRhdGVGb3JtKCkgKSB7XG4gICAgICB0aGlzLm1vZGUoNCk7XG4gICAgICByZXR1cm47XG4gICAgfVxuICAgIHRoaXMubW9kZSgzKTtcbiAgICBsZXQgc2VsZiA9IHRoaXM7XG4gICAgbGV0IGRhdGEgPSB7XG4gICAgICBhY3Rpb246ICdrYWhfc2VuZF90ZW50X2NvbmZpZ3VyYXRvcicsXG4gICAgICBmaXJzdE5hbWU6IHRoaXMuZm9ybS5maXJzdE5hbWUoKSxcbiAgICAgIGxhc3ROYW1lOiB0aGlzLmZvcm0ubGFzdE5hbWUoKSxcbiAgICAgIHNhbHV0YXRpb246IHRoaXMuZm9ybS5zYWx1dGF0aW9uKCksXG4gICAgICBjb21wYW55OiB0aGlzLmZvcm0uY29tcGFueSgpLFxuICAgICAgc3RyZWV0OiB0aGlzLmZvcm0uc3RyZWV0KCksXG4gICAgICBzdHJlZXRucjogdGhpcy5mb3JtLnN0cmVldG5yKCksXG4gICAgICB6aXA6IHRoaXMuZm9ybS56aXAoKSxcbiAgICAgIGxvY2F0aW9uOiB0aGlzLmZvcm0ubG9jYXRpb24oKSxcbiAgICAgIGVtYWlsOiB0aGlzLmZvcm0uZW1haWwoKSxcbiAgICAgIHBob25lOiB0aGlzLmZvcm0ucGhvbmUoKSxcbiAgICAgIHNlbGVjdGVkVGVudHM6IHRoaXMuZm9ybS5zZWxlY3RlZFRlbnRzKCksXG4gICAgICBzZWxlY3RlZEVxdWlwbWVudHM6IHRoaXMuZm9ybS5zZWxlY3RlZEVxdWlwbWVudHMoKSxcbiAgICAgIHRvdGFsVGVudHNQcmljZTogdGhpcy5mb3JtLnRvdGFsVGVudHNQcmljZSgpLFxuICAgICAgdG90YWxFcXVpcG1lbnRzUHJpY2U6IHRoaXMuZm9ybS50b3RhbEVxdWlwbWVudHNQcmljZSgpLFxuICAgICAgdG90YWxQcmljZTogdGhpcy5mb3JtLnRvdGFsUHJpY2UoKSxcbiAgICAgIHRvdGFsTWluUGVyc29uczogdGhpcy5mb3JtLnRvdGFsTWluUGVyc29ucygpLFxuICAgICAgdG90YWxNYXhQZXJzb25zOiB0aGlzLmZvcm0udG90YWxNYXhQZXJzb25zKCksXG4gICAgICB0b3RhbFNxdWFyZU1ldGVyczogdGhpcy5mb3JtLnRvdGFsU3F1YXJlTWV0ZXJzKClcbiAgICB9O1xuICAgIGxldCByZXF1ZXN0ID0gdGhpcy5fbWFrZV9yZXF1ZXN0KGRhdGEpO1xuICAgIHJlcXVlc3QudGhlbihcbiAgICAgIGZ1bmN0aW9uKCkgeyBzZWxmLm1vZGUoMSk7IH0sXG4gICAgICBmdW5jdGlvbigpIHsgc2VsZi5tb2RlKDIpOyB9KTtcbiAgfVxuICByZWFkYWJsZVByaWNlKHByaWNlKSB7XG4gICAgcmV0dXJuIHByaWNlICsgJyBDSEYnO1xuICB9XG4gIHJlYWRhYmxlUGVyc29ucyhtaW5QZXJzb25zLCBtYXhQZXJzb25zKSB7XG4gICAgcmV0dXJuIG1pblBlcnNvbnMgKyAnIC0gJyArIG1heFBlcnNvbnMgKyAnIFBlcnNvbmVuJztcbiAgfVxuICBjdXJyZW50V2l6YXJkU3RlcElkKCkge1xuICAgIHJldHVybiB0aGlzLnN0ZXBzKCkuaW5kZXhPZih0aGlzLmN1cnJlbnRTdGVwKCkpO1xuICB9XG4gIF9tYWtlX3JlcXVlc3QoZGF0YSkge1xuICAgIGxldCBzZWxmID0gdGhpcztcbiAgICByZXR1cm4gbmV3IFByb21pc2UoZnVuY3Rpb24ocmVzb2x2ZSwgcmVqZWN0KSB7XG5cbiAgICAgIGlmICggc2VsZi5kZWJ1ZyApIHtcbiAgICAgICAgd2luZG93LnNldFRpbWVvdXQoZnVuY3Rpb24oKSB7XG4gICAgICAgICAgcmVzb2x2ZSgpO1xuICAgICAgICB9LCAyMDAwKTtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIGpRdWVyeS5wb3N0KGFqYXh1cmwsIGRhdGEpXG4gICAgICAgICAgLmRvbmUoZnVuY3Rpb24oKSB7IHJlc29sdmUoKTsgfSlcbiAgICAgICAgICAuZmFpbChmdW5jdGlvbigpIHsgcmVqZWN0KCk7IH0pO1xuICAgICAgfVxuICAgIH0pO1xuICB9XG4gIHZhbGlkYXRlRm9ybSgpIHtcbiAgICBsZXQgdmFsaWQgPSB0cnVlO1xuICAgICQoJ2lucHV0W3JlcXVpcmVkXSwgc2VsZWN0W3JlcXVpcmVkXScpLmVhY2goZnVuY3Rpb24oc2VsZikge1xuICAgICAgcmV0dXJuIGZ1bmN0aW9uKGNvdW50ZXIsIGZpZWxkKSB7XG4gICAgICAgIGlmICggIXNlbGYudmFsaWRhdGVGaWVsZChmaWVsZCkgKSB7IHZhbGlkID0gZmFsc2U7IH1cbiAgICAgIH07XG4gICAgfSh0aGlzKSk7XG4gICAgcmV0dXJuIHZhbGlkO1xuICB9XG4gIHZhbGlkYXRlRmllbGQoZmllbGQpIHtcbiAgICBsZXQgbXNnQm94ID0gZmllbGQucHJldmlvdXNFbGVtZW50U2libGluZztcbiAgICBpZiAoIGZpZWxkLmNoZWNrVmFsaWRpdHkoKSApIHtcbiAgICAgICQobXNnQm94KS5oaWRlKCk7XG4gICAgICByZXR1cm4gdHJ1ZTtcbiAgICB9IGVsc2Uge1xuICAgICAgbXNnQm94LmlubmVySFRNTCA9IGZpZWxkLnZhbGlkYXRpb25NZXNzYWdlO1xuICAgICAgJChtc2dCb3gpLnNob3coKTtcbiAgICAgIHJldHVybiBmYWxzZTtcbiAgICB9XG4gIH1cbiAgY2FsY3VsYXRlRGlzdGFuY2UocGxhY2UpIHtcbiAgICBsZXQgc2VsZiA9IHRoaXM7XG4gICAgY29uc29sZS5sb2coc2VsZik7XG5cbiAgICBsZXQgb3JpZ2luID0gJ0hhdXB0c3RyYXNzZSA5NSwgMTcxNSBBbHRlcnN3aWwsIFNjaHdlaXonO1xuICAgIGxldCBkZXN0aW5hdGlvbiA9IG5ldyBnb29nbGUubWFwcy5MYXRMbmcocGxhY2UuZ2VvbWV0cnkubG9jYXRpb24ubGF0KCksIHBsYWNlLmdlb21ldHJ5LmxvY2F0aW9uLmxuZygpKTtcbiAgICBsZXQgc2VydmljZSA9IG5ldyBnb29nbGUubWFwcy5EaXN0YW5jZU1hdHJpeFNlcnZpY2UoKTtcbiAgICBzZXJ2aWNlLmdldERpc3RhbmNlTWF0cml4KHtcbiAgICAgIG9yaWdpbnM6IFtvcmlnaW5dLFxuICAgICAgZGVzdGluYXRpb25zOiBbZGVzdGluYXRpb25dLFxuICAgICAgdHJhdmVsTW9kZTogZ29vZ2xlLm1hcHMuVHJhdmVsTW9kZS5EUklWSU5HLH0sXG4gICAgICBmdW5jdGlvbihyZXNwb25zZSwgc3RhdHVzKSB7XG4gICAgICAgIGlmIChzdGF0dXMgPT0gZ29vZ2xlLm1hcHMuRGlzdGFuY2VNYXRyaXhTdGF0dXMuT0spIHtcbiAgICAgICAgICBsZXQgZGlzdGFuY2VtYXRyaXggPSByZXNwb25zZS5yb3dzWzBdLmVsZW1lbnRzWzBdO1xuICAgICAgICAgIGlmIChkaXN0YW5jZW1hdHJpeC5zdGF0dXMgPT0gZ29vZ2xlLm1hcHMuRGlzdGFuY2VNYXRyaXhTdGF0dXMuT0spIHtcbiAgICAgICAgICAgIHNlbGYuZm9ybS5ldmVudGxvY2F0aW9uZGlzdGFuY2UoZGlzdGFuY2VtYXRyaXguZGlzdGFuY2UudmFsdWUpO1xuICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgfVxuICAgICk7XG5cbiAgfVxuICBpbml0R29vZ2xlU2VhcmNoKCkge1xuICAgIC8vIFdlIGNhbGwgdGhpcyBmdW5jaXRvbiBmcm9tIG91dHNpZGUuIFNvIHdlIGhhdmUgdG8gc2V0IFxuICAgIC8vIHRoZSB3aXphcmQgaXRzZWxmIHRvIGJlIGFibGUgdG8gYWNjZXNzIGl0cyBmdW5jdGlvbnMuXG4gICAgbGV0IHNlbGYgPSB3aW5kb3cud2l6YXJkO1xuICAgIGpRdWVyeSh3aW5kb3cpLm9uKCdsb2FkJywgZnVuY3Rpb24oKSB7XG4gICAgICB2YXIgaW5wdXQgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnZXZlbnRsb2NhdGlvbicpO1xuICAgICAgdmFyIHNlYXJjaEJveCA9IG5ldyBnb29nbGUubWFwcy5wbGFjZXMuU2VhcmNoQm94KGlucHV0KTtcbiAgICAgIHNlYXJjaEJveC5hZGRMaXN0ZW5lcigncGxhY2VzX2NoYW5nZWQnLCBmdW5jdGlvbigpIHtcbiAgICAgICAgc2VsZi5jYWxjdWxhdGVEaXN0YW5jZShzZWFyY2hCb3guZ2V0UGxhY2VzKClbMF0pO1xuICAgICAgfSk7XG4gICAgfSk7XG4gIH07XG59XG5cbndpbmRvdy53aXphcmQgPSBuZXcgV2l6YXJkKCk7XG52YXIgaW5pdEdvb2dsZVNlYXJjaCA9IHdpbmRvdy53aXphcmQuaW5pdEdvb2dsZVNlYXJjaDtcblxualF1ZXJ5KHdpbmRvdykub24oJ2xvYWQnLCBmdW5jdGlvbigpIHtcbiAga28uYXBwbHlCaW5kaW5ncyh3aW5kb3cud2l6YXJkLCBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnd2l6YXJkLWZvcm0nKSk7XG59KTtcbiJdfQ==
