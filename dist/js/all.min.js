'use strict';

var _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if ("value" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();

function _possibleConstructorReturn(self, call) { if (!self) { throw new ReferenceError("this hasn't been initialised - super() hasn't been called"); } return call && (typeof call === "object" || typeof call === "function") ? call : self; }

function _inherits(subClass, superClass) { if (typeof superClass !== "function" && superClass !== null) { throw new TypeError("Super expression must either be null or a function, not " + typeof superClass); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, enumerable: false, writable: true, configurable: true } }); if (superClass) Object.setPrototypeOf ? Object.setPrototypeOf(subClass, superClass) : subClass.__proto__ = superClass; }

function _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError("Cannot call a class as a function"); } }

var Tent = function Tent(name, price, length, width, minPersons, maxPersons) {
  _classCallCheck(this, Tent);

  this.name = name;
  this.price = price;
  this.length = length;
  this.width = width;
  this.minPersons = minPersons;
  this.maxPersons = maxPersons;
  this.squareMeter = this.length * this.width;
};

var Equipment = function Equipment(title, price, description) {
  _classCallCheck(this, Equipment);

  this.title = title;
  this.price = price;
  this.description = description;
};

var tents = [new Tent('Zelttitel 1', 15, 4, 20, 100, 150), new Tent('Zelttitel 2', 30, 8, 20, 200, 300), new Tent('Zelttitel 3', 50, 12, 20, 150, 300)];

var equipments = [new Equipment('Lampe', 5, 'kleine Lampe f端r das DJ Pult'), new Equipment('Bodenplatte 30x30 cm', 2, 'Um den Boden zu sch端tzen'), new Equipment('Tisch - 3 Meter ', 9, "f端r 6 Personen"), new Equipment('Tisch - 5 Meter ', 9, "f端r 9 Personen")];

var WizardStep = function () {
  function WizardStep() {
    var name = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : '';
    var wizardForm = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : null;

    _classCallCheck(this, WizardStep);

    this.name = name;
    this.active = ko.observable(false);
    this.activeSubStep = ko.observable();
    this.wizardForm = wizardForm;
    this.isVisible = ko.computed(function () {
      return this.active() && !this.activeSubStep();
    }, this);
  }

  _createClass(WizardStep, [{
    key: 'openSubStep',
    value: function openSubStep(substep) {
      substep.active(true);
      this.activeSubStep(substep);
    }
  }, {
    key: 'closeSubStep',
    value: function closeSubStep() {
      this.activeSubStep().active(false);
      this.activeSubStep(null);
    }
  }, {
    key: 'removeDataRow',
    value: function removeDataRow() {
      throw new Error('Override this function');
    }
  }]);

  return WizardStep;
}();

var WizardSubStep = function (_WizardStep) {
  _inherits(WizardSubStep, _WizardStep);

  function WizardSubStep(parent) {
    var _ref;

    _classCallCheck(this, WizardSubStep);

    for (var _len = arguments.length, args = Array(_len > 1 ? _len - 1 : 0), _key = 1; _key < _len; _key++) {
      args[_key - 1] = arguments[_key];
    }

    var _this = _possibleConstructorReturn(this, (_ref = WizardSubStep.__proto__ || Object.getPrototypeOf(WizardSubStep)).call.apply(_ref, [this].concat(args)));

    _this.parent = parent;
    _this.isVisible = ko.computed(function () {
      return this.active() && this.parent.active();
    }, _this);
    return _this;
  }

  return WizardSubStep;
}(WizardStep);

var WizardStepTents = function (_WizardStep2) {
  _inherits(WizardStepTents, _WizardStep2);

  function WizardStepTents() {
    var _ref2;

    _classCallCheck(this, WizardStepTents);

    for (var _len2 = arguments.length, args = Array(_len2), _key2 = 0; _key2 < _len2; _key2++) {
      args[_key2] = arguments[_key2];
    }

    var _this2 = _possibleConstructorReturn(this, (_ref2 = WizardStepTents.__proto__ || Object.getPrototypeOf(WizardStepTents)).call.apply(_ref2, [this].concat(args)));

    _this2.selectTentsSubStep = new WizardStepSelectTents(_this2);
    _this2.openSubStep(_this2.selectTentsSubStep);
    return _this2;
  }

  _createClass(WizardStepTents, [{
    key: 'openSelectTent',
    value: function openSelectTent() {
      this.openSubStep(this.selectTentsSubStep);
    }
  }, {
    key: 'removeDataRow',
    value: function removeDataRow(tent) {
      this.wizardForm.selectedTents.remove(tent);
    }
  }]);

  return WizardStepTents;
}(WizardStep);

var WizardStepEquipments = function (_WizardStep3) {
  _inherits(WizardStepEquipments, _WizardStep3);

  function WizardStepEquipments() {
    var _ref3;

    _classCallCheck(this, WizardStepEquipments);

    for (var _len3 = arguments.length, args = Array(_len3), _key3 = 0; _key3 < _len3; _key3++) {
      args[_key3] = arguments[_key3];
    }

    var _this3 = _possibleConstructorReturn(this, (_ref3 = WizardStepEquipments.__proto__ || Object.getPrototypeOf(WizardStepEquipments)).call.apply(_ref3, [this].concat(args)));

    _this3.selectEquipmentSubStep = new WizardStepSelectEquipment(_this3);
    _this3.openSubStep(_this3.selectEquipmentSubStep);
    return _this3;
  }

  _createClass(WizardStepEquipments, [{
    key: 'openSelectEquipment',
    value: function openSelectEquipment() {
      this.openSubStep(this.selectEquipmentSubStep);
    }
  }, {
    key: 'removeDataRow',
    value: function removeDataRow(equipment) {
      this.wizardForm.selectedEquipments.remove(equipment);
    }
  }]);

  return WizardStepEquipments;
}(WizardStep);

var WizardStepEvent = function (_WizardStep4) {
  _inherits(WizardStepEvent, _WizardStep4);

  function WizardStepEvent() {
    _classCallCheck(this, WizardStepEvent);

    return _possibleConstructorReturn(this, (WizardStepEvent.__proto__ || Object.getPrototypeOf(WizardStepEvent)).apply(this, arguments));
  }

  return WizardStepEvent;
}(WizardStep);

var WizardStepContact = function (_WizardStep5) {
  _inherits(WizardStepContact, _WizardStep5);

  function WizardStepContact() {
    var _ref4;

    _classCallCheck(this, WizardStepContact);

    for (var _len4 = arguments.length, args = Array(_len4), _key4 = 0; _key4 < _len4; _key4++) {
      args[_key4] = arguments[_key4];
    }

    var _this5 = _possibleConstructorReturn(this, (_ref4 = WizardStepContact.__proto__ || Object.getPrototypeOf(WizardStepContact)).call.apply(_ref4, [this].concat(args)));

    _this5.availableGenders = ko.observableArray(['', 'Herr', 'Frau']);
    return _this5;
  }

  return WizardStepContact;
}(WizardStep);

var WizardStepSelectTents = function (_WizardSubStep) {
  _inherits(WizardStepSelectTents, _WizardSubStep);

  function WizardStepSelectTents(parent) {
    var _ref5;

    _classCallCheck(this, WizardStepSelectTents);

    for (var _len5 = arguments.length, args = Array(_len5 > 1 ? _len5 - 1 : 0), _key5 = 1; _key5 < _len5; _key5++) {
      args[_key5 - 1] = arguments[_key5];
    }

    return _possibleConstructorReturn(this, (_ref5 = WizardStepSelectTents.__proto__ || Object.getPrototypeOf(WizardStepSelectTents)).call.apply(_ref5, [this, parent].concat(args)));
  }

  _createClass(WizardStepSelectTents, [{
    key: 'selectTent',
    value: function selectTent(tent) {
      this.parent.wizardForm.selectedTents.push(Object.assign(new Tent(), tent));
      this.parent.closeSubStep();
    }
  }]);

  return WizardStepSelectTents;
}(WizardSubStep);

var WizardStepSelectEquipment = function (_WizardSubStep2) {
  _inherits(WizardStepSelectEquipment, _WizardSubStep2);

  function WizardStepSelectEquipment() {
    _classCallCheck(this, WizardStepSelectEquipment);

    return _possibleConstructorReturn(this, (WizardStepSelectEquipment.__proto__ || Object.getPrototypeOf(WizardStepSelectEquipment)).apply(this, arguments));
  }

  _createClass(WizardStepSelectEquipment, [{
    key: 'selectEquipment',
    value: function selectEquipment(equipment) {
      this.parent.wizardForm.selectedEquipments.push(Object.assign(new Equipment(), equipment));
      this.parent.closeSubStep();
    }
  }]);

  return WizardStepSelectEquipment;
}(WizardSubStep);

var WizardForm = function () {
  function WizardForm() {
    _classCallCheck(this, WizardForm);

    this.firstName = ko.observable();
    this.lastName = ko.observable();
    this.salutation = ko.observable();
    this.company = ko.observable();
    this.street = ko.observable();
    this.streetnr = ko.observable();
    this.zip = ko.observable();
    this.location = ko.observable();
    this.email = ko.observable();
    this.phone = ko.observable();
    this.eventdays = ko.observable(1);
    this.eventlocation = ko.observable();
    this.eventlocationdistance = ko.observable(0);

    this.tents = ko.observableArray(tents.sort(function (a, b) {
      return a.minPersons - b.minPersons;
    }));
    this.equipments = ko.observableArray(equipments);
    this.selectedTents = ko.observableArray();
    this.selectedEquipments = ko.observableArray();
    this.transportPrice = ko.computed(function () {
      if (this.eventlocationdistance() <= 10000) {
        return 0;
      } else {
        // 50.- each 30km * 2 (for twice the distance)
        return Math.ceil(this.eventlocationdistance() / 1000 / 30) * 50 * 2;
      }
    }, this);
    this.totalTentsPrice = ko.computed(function () {
      return this._count_objs_attribute(this.selectedTents(), 'price');
    }, this);
    this.totalEquipmentsPrice = ko.computed(function () {
      return this._count_objs_attribute(this.selectedEquipments(), 'price');
    }, this);
    this.totalPrice = ko.computed(function () {
      return (this.totalTentsPrice() + this.totalEquipmentsPrice()) * this.eventdays() + this.transportPrice();
    }, this);
    this.totalMinPersons = ko.computed(function () {
      return this._count_objs_attribute(this.selectedTents(), 'minPersons');
    }, this);
    this.totalMaxPersons = ko.computed(function () {
      return this._count_objs_attribute(this.selectedTents(), 'maxPersons');
    }, this);
    this.totalSquareMeters = ko.computed(function () {
      return this._count_objs_attribute(this.selectedTents(), 'squareMeter');
    }, this);
  }

  _createClass(WizardForm, [{
    key: '_count_objs_attribute',
    value: function _count_objs_attribute(objs, attr) {
      var total = 0;
      objs.forEach(function (obj) {
        total += obj[attr];
      });
      return total;
    }
  }]);

  return WizardForm;
}();

var Wizard = function () {
  function Wizard() {
    _classCallCheck(this, Wizard);

    this.debug = false;
    if (typeof ajaxurl === 'undefined') {
      // wordpress sets the ajaxurl in the global scope.
      // If the ajaxurl is not initialized, we are not in a wordpress
      // environment.
      this.debug = true;
    }
    this.form = new WizardForm();
    // 0 = Fillout, 1 = Success, 2 = Error, 3 = pending, 4 = FormValidation error
    this.mode = ko.observable(0);
    this.steps = ko.observableArray([new WizardStepTents('Zelt', this.form), new WizardStepEquipments('Zubeh旦r', this.form), new WizardStepEvent('Anlass', this.form), new WizardStepContact('Kontakt', this.form)]);
    this.addressNotFound = ko.observable(false);
    this.currentStep = ko.observable(this.steps()[0]);
    this.isLastStep = ko.computed(function () {
      return this.currentWizardStepId() >= this.steps().length - 1;
    }, this);
    this.showPrevButton = ko.computed(function () {
      return this.currentWizardStepId() > 0;
    }, this);
    this.nextButtonText = ko.computed(function () {
      if (this.isLastStep()) {
        return "Offerte anfordern";
      }
      return "Weiter";
    }, this);
    this.showNextButton = true;
    // this.showSendButton = ko.computed(function() {
    //   return this.currentWizardStepId() == this.steps().length -1;
    // }, this);
    ko.computed(function () {
      var _iteratorNormalCompletion = true;
      var _didIteratorError = false;
      var _iteratorError = undefined;

      try {
        for (var _iterator = this.steps()[Symbol.iterator](), _step; !(_iteratorNormalCompletion = (_step = _iterator.next()).done); _iteratorNormalCompletion = true) {
          var step = _step.value;

          step.active(false);
          if (this.currentStep() == step) {
            step.active(true);
          }
        }
      } catch (err) {
        _didIteratorError = true;
        _iteratorError = err;
      } finally {
        try {
          if (!_iteratorNormalCompletion && _iterator.return) {
            _iterator.return();
          }
        } finally {
          if (_didIteratorError) {
            throw _iteratorError;
          }
        }
      }
    }, this);

    jQuery(document).on('focusout', 'input[required], select[required]', function (self) {
      return function () {
        self.validateField(this);
      };
    }(this));
  }

  _createClass(Wizard, [{
    key: 'next',
    value: function next() {
      if (this.isLastStep()) {
        this.send();
      } else {
        this.currentStep(this.steps()[this.currentWizardStepId() + 1]);
      }
    }
  }, {
    key: 'previous',
    value: function previous() {
      this.currentStep(this.steps()[this.currentWizardStepId() - 1]);
    }
  }, {
    key: 'send',
    value: function send() {
      jQuery(window).scrollTop(0);
      if (!this.validateForm()) {
        this.mode(4);
        return;
      }
      this.mode(3);
      var self = this;
      var data = {
        action: 'kah_send_tent_configurator',
        firstName: this.form.firstName(),
        lastName: this.form.lastName(),
        salutation: this.form.salutation(),
        company: this.form.company(),
        street: this.form.street(),
        streetnr: this.form.streetnr(),
        zip: this.form.zip(),
        location: this.form.location(),
        email: this.form.email(),
        phone: this.form.phone(),
        selectedTents: this.form.selectedTents(),
        selectedEquipments: this.form.selectedEquipments(),
        totalTentsPrice: this.form.totalTentsPrice(),
        totalEquipmentsPrice: this.form.totalEquipmentsPrice(),
        totalPrice: this.form.totalPrice(),
        totalMinPersons: this.form.totalMinPersons(),
        totalMaxPersons: this.form.totalMaxPersons(),
        totalSquareMeters: this.form.totalSquareMeters()
      };
      var request = this._make_request(data);
      request.then(function () {
        self.mode(1);
      }, function () {
        self.mode(2);
      });
    }
  }, {
    key: 'readablePrice',
    value: function readablePrice(price) {
      return price + ' CHF';
    }
  }, {
    key: 'readablePersons',
    value: function readablePersons(minPersons, maxPersons) {
      return minPersons + ' - ' + maxPersons + ' Personen';
    }
  }, {
    key: 'currentWizardStepId',
    value: function currentWizardStepId() {
      return this.steps().indexOf(this.currentStep());
    }
  }, {
    key: '_make_request',
    value: function _make_request(data) {
      var self = this;
      return new Promise(function (resolve, reject) {

        if (self.debug) {
          window.setTimeout(function () {
            resolve();
          }, 2000);
        } else {
          jQuery.post(ajaxurl, data).done(function () {
            resolve();
          }).fail(function () {
            reject();
          });
        }
      });
    }
  }, {
    key: 'validateForm',
    value: function validateForm() {
      var valid = true;
      var setInvalidForm = true;
      $('input[required], select[required]').each(function (self) {
        return function (counter, field) {
          if (!self.validateField(field)) {
            valid = false;
            if (setInvalidForm) {
              self.currentStep(ko.dataFor($(field).closest('.wizardStepView')[0]));
              setInvalidForm = false;
            }
          }
        };
      }(this));
      return valid;
    }
  }, {
    key: 'validateField',
    value: function validateField(field) {
      var msgBox = field.previousElementSibling;
      if (field.checkValidity()) {
        $(msgBox).hide();
        return true;
      } else {
        msgBox.innerHTML = field.validationMessage;
        $(msgBox).show();
        return false;
      }
    }
  }, {
    key: 'calculateDistance',
    value: function calculateDistance(place) {
      var self = this;
      console.log(place);
      if (typeof place === 'undefined') {
        self.addressNotFound(true);
        return;
      };

      var origin = 'Hauptstrasse 95, 1715 Alterswil, Schweiz';
      var destination = new google.maps.LatLng(place.geometry.location.lat(), place.geometry.location.lng());
      var service = new google.maps.DistanceMatrixService();
      service.getDistanceMatrix({
        origins: [origin],
        destinations: [destination],
        travelMode: google.maps.TravelMode.DRIVING }, function (response, status) {
        if (status == google.maps.DistanceMatrixStatus.OK) {
          var distancematrix = response.rows[0].elements[0];
          if (distancematrix.status == google.maps.DistanceMatrixStatus.OK) {
            self.form.eventlocationdistance(distancematrix.distance.value);
            self.addressNotFound(false);
          }
        }
      });
    }
  }, {
    key: 'initGoogleSearch',
    value: function initGoogleSearch() {
      // We call this funciton from outside. So we have to set 
      // the wizard itself to be able to access its functions.
      var self = window.wizard;
      jQuery(window).on('load', function () {
        var input = document.getElementById('eventlocation');
        var searchBox = new google.maps.places.SearchBox(input);
        searchBox.addListener('places_changed', function () {
          self.calculateDistance(searchBox.getPlaces()[0]);
        });
        google.maps.event.addDomListener(input, 'keydown', function (e) {
          if (e.keyCode == 13) {
            e.preventDefault();
          }
        });
      });
    }
  }]);

  return Wizard;
}();

window.wizard = new Wizard();
var initGoogleSearch = window.wizard.initGoogleSearch;

jQuery(window).on('load', function () {
  ko.applyBindings(window.wizard, document.getElementById('wizard-form'));
});
//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIm1haW4uanMiXSwibmFtZXMiOlsiVGVudCIsIm5hbWUiLCJwcmljZSIsImxlbmd0aCIsIndpZHRoIiwibWluUGVyc29ucyIsIm1heFBlcnNvbnMiLCJzcXVhcmVNZXRlciIsIkVxdWlwbWVudCIsInRpdGxlIiwiZGVzY3JpcHRpb24iLCJ0ZW50cyIsImVxdWlwbWVudHMiLCJXaXphcmRTdGVwIiwid2l6YXJkRm9ybSIsImFjdGl2ZSIsImtvIiwib2JzZXJ2YWJsZSIsImFjdGl2ZVN1YlN0ZXAiLCJpc1Zpc2libGUiLCJjb21wdXRlZCIsInN1YnN0ZXAiLCJFcnJvciIsIldpemFyZFN1YlN0ZXAiLCJwYXJlbnQiLCJhcmdzIiwiV2l6YXJkU3RlcFRlbnRzIiwic2VsZWN0VGVudHNTdWJTdGVwIiwiV2l6YXJkU3RlcFNlbGVjdFRlbnRzIiwib3BlblN1YlN0ZXAiLCJ0ZW50Iiwic2VsZWN0ZWRUZW50cyIsInJlbW92ZSIsIldpemFyZFN0ZXBFcXVpcG1lbnRzIiwic2VsZWN0RXF1aXBtZW50U3ViU3RlcCIsIldpemFyZFN0ZXBTZWxlY3RFcXVpcG1lbnQiLCJlcXVpcG1lbnQiLCJzZWxlY3RlZEVxdWlwbWVudHMiLCJXaXphcmRTdGVwRXZlbnQiLCJXaXphcmRTdGVwQ29udGFjdCIsImF2YWlsYWJsZUdlbmRlcnMiLCJvYnNlcnZhYmxlQXJyYXkiLCJwdXNoIiwiT2JqZWN0IiwiYXNzaWduIiwiY2xvc2VTdWJTdGVwIiwiV2l6YXJkRm9ybSIsImZpcnN0TmFtZSIsImxhc3ROYW1lIiwic2FsdXRhdGlvbiIsImNvbXBhbnkiLCJzdHJlZXQiLCJzdHJlZXRuciIsInppcCIsImxvY2F0aW9uIiwiZW1haWwiLCJwaG9uZSIsImV2ZW50ZGF5cyIsImV2ZW50bG9jYXRpb24iLCJldmVudGxvY2F0aW9uZGlzdGFuY2UiLCJzb3J0IiwiYSIsImIiLCJ0cmFuc3BvcnRQcmljZSIsIk1hdGgiLCJjZWlsIiwidG90YWxUZW50c1ByaWNlIiwiX2NvdW50X29ianNfYXR0cmlidXRlIiwidG90YWxFcXVpcG1lbnRzUHJpY2UiLCJ0b3RhbFByaWNlIiwidG90YWxNaW5QZXJzb25zIiwidG90YWxNYXhQZXJzb25zIiwidG90YWxTcXVhcmVNZXRlcnMiLCJvYmpzIiwiYXR0ciIsInRvdGFsIiwiZm9yRWFjaCIsIm9iaiIsIldpemFyZCIsImRlYnVnIiwiYWpheHVybCIsImZvcm0iLCJtb2RlIiwic3RlcHMiLCJhZGRyZXNzTm90Rm91bmQiLCJjdXJyZW50U3RlcCIsImlzTGFzdFN0ZXAiLCJjdXJyZW50V2l6YXJkU3RlcElkIiwic2hvd1ByZXZCdXR0b24iLCJuZXh0QnV0dG9uVGV4dCIsInNob3dOZXh0QnV0dG9uIiwic3RlcCIsImpRdWVyeSIsImRvY3VtZW50Iiwib24iLCJzZWxmIiwidmFsaWRhdGVGaWVsZCIsInNlbmQiLCJ3aW5kb3ciLCJzY3JvbGxUb3AiLCJ2YWxpZGF0ZUZvcm0iLCJkYXRhIiwiYWN0aW9uIiwicmVxdWVzdCIsIl9tYWtlX3JlcXVlc3QiLCJ0aGVuIiwiaW5kZXhPZiIsIlByb21pc2UiLCJyZXNvbHZlIiwicmVqZWN0Iiwic2V0VGltZW91dCIsInBvc3QiLCJkb25lIiwiZmFpbCIsInZhbGlkIiwic2V0SW52YWxpZEZvcm0iLCIkIiwiZWFjaCIsImNvdW50ZXIiLCJmaWVsZCIsImRhdGFGb3IiLCJjbG9zZXN0IiwibXNnQm94IiwicHJldmlvdXNFbGVtZW50U2libGluZyIsImNoZWNrVmFsaWRpdHkiLCJoaWRlIiwiaW5uZXJIVE1MIiwidmFsaWRhdGlvbk1lc3NhZ2UiLCJzaG93IiwicGxhY2UiLCJjb25zb2xlIiwibG9nIiwib3JpZ2luIiwiZGVzdGluYXRpb24iLCJnb29nbGUiLCJtYXBzIiwiTGF0TG5nIiwiZ2VvbWV0cnkiLCJsYXQiLCJsbmciLCJzZXJ2aWNlIiwiRGlzdGFuY2VNYXRyaXhTZXJ2aWNlIiwiZ2V0RGlzdGFuY2VNYXRyaXgiLCJvcmlnaW5zIiwiZGVzdGluYXRpb25zIiwidHJhdmVsTW9kZSIsIlRyYXZlbE1vZGUiLCJEUklWSU5HIiwicmVzcG9uc2UiLCJzdGF0dXMiLCJEaXN0YW5jZU1hdHJpeFN0YXR1cyIsIk9LIiwiZGlzdGFuY2VtYXRyaXgiLCJyb3dzIiwiZWxlbWVudHMiLCJkaXN0YW5jZSIsInZhbHVlIiwid2l6YXJkIiwiaW5wdXQiLCJnZXRFbGVtZW50QnlJZCIsInNlYXJjaEJveCIsInBsYWNlcyIsIlNlYXJjaEJveCIsImFkZExpc3RlbmVyIiwiY2FsY3VsYXRlRGlzdGFuY2UiLCJnZXRQbGFjZXMiLCJldmVudCIsImFkZERvbUxpc3RlbmVyIiwiZSIsImtleUNvZGUiLCJwcmV2ZW50RGVmYXVsdCIsImluaXRHb29nbGVTZWFyY2giLCJhcHBseUJpbmRpbmdzIl0sIm1hcHBpbmdzIjoiOzs7Ozs7Ozs7O0lBQU1BLE9BQ0osY0FBWUMsSUFBWixFQUFrQkMsS0FBbEIsRUFBeUJDLE1BQXpCLEVBQWlDQyxLQUFqQyxFQUF3Q0MsVUFBeEMsRUFBb0RDLFVBQXBELEVBQWdFO0FBQUE7O0FBQzlELE9BQUtMLElBQUwsR0FBWUEsSUFBWjtBQUNBLE9BQUtDLEtBQUwsR0FBYUEsS0FBYjtBQUNBLE9BQUtDLE1BQUwsR0FBY0EsTUFBZDtBQUNBLE9BQUtDLEtBQUwsR0FBYUEsS0FBYjtBQUNBLE9BQUtDLFVBQUwsR0FBa0JBLFVBQWxCO0FBQ0EsT0FBS0MsVUFBTCxHQUFrQkEsVUFBbEI7QUFDQSxPQUFLQyxXQUFMLEdBQW1CLEtBQUtKLE1BQUwsR0FBYyxLQUFLQyxLQUF0QztBQUNEOztJQUdHSSxZQUNKLG1CQUFZQyxLQUFaLEVBQW1CUCxLQUFuQixFQUEwQlEsV0FBMUIsRUFBdUM7QUFBQTs7QUFDckMsT0FBS0QsS0FBTCxHQUFhQSxLQUFiO0FBQ0EsT0FBS1AsS0FBTCxHQUFhQSxLQUFiO0FBQ0EsT0FBS1EsV0FBTCxHQUFtQkEsV0FBbkI7QUFDRDs7QUFHSCxJQUFJQyxRQUFRLENBQ1YsSUFBSVgsSUFBSixDQUFTLGFBQVQsRUFBd0IsRUFBeEIsRUFBNEIsQ0FBNUIsRUFBK0IsRUFBL0IsRUFBbUMsR0FBbkMsRUFBd0Ms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QVosQ0FBbUJDLFNBQXZCLENBQWlDSixLQUFqQyxDQUFoQjtBQUNBRSxrQkFBVUcsV0FBVixDQUFzQixnQkFBdEIsRUFBd0MsWUFBVztBQUNqRHBFLGVBQUtxRSxpQkFBTCxDQUF1QkosVUFBVUssU0FBVixHQUFzQixDQUF0QixDQUF2QjtBQUNELFNBRkQ7QUFHQS9CLGVBQU9DLElBQVAsQ0FBWStCLEtBQVosQ0FBa0JDLGNBQWxCLENBQWlDVCxLQUFqQyxFQUF3QyxTQUF4QyxFQUFtRCxVQUFTVSxDQUFULEVBQVk7QUFDN0QsY0FBSUEsRUFBRUMsT0FBRixJQUFhLEVBQWpCLEVBQXFCO0FBQ2pCRCxjQUFFRSxjQUFGO0FBQ0g7QUFDRixTQUpEO0FBS0QsT0FYRDtBQVlEOzs7Ozs7QUFHSHhFLE9BQU8yRCxNQUFQLEdBQWdCLElBQUkvRSxNQUFKLEVBQWhCO0FBQ0EsSUFBSTZGLG1CQUFtQnpFLE9BQU8yRCxNQUFQLENBQWNjLGdCQUFyQzs7QUFFQS9FLE9BQU9NLE1BQVAsRUFBZUosRUFBZixDQUFrQixNQUFsQixFQUEwQixZQUFXO0FBQ25DOUUsS0FBRzRKLGFBQUgsQ0FBaUIxRSxPQUFPMkQsTUFBeEIsRUFBZ0NoRSxTQUFTa0UsY0FBVCxDQUF3QixhQUF4QixDQUFoQztBQUNELENBRkQiLCJmaWxlIjoiYWxsLm1pbi5qcyIsInNvdXJjZXNDb250ZW50IjpbImNsYXNzIFRlbnQge1xuICBjb25zdHJ1Y3RvcihuYW1lLCBwcmljZSwgbGVuZ3RoLCB3aWR0aCwgbWluUGVyc29ucywgbWF4UGVyc29ucykge1xuICAgIHRoaXMubmFtZSA9IG5hbWU7XG4gICAgdGhpcy5wcmljZSA9IHByaWNlO1xuICAgIHRoaXMubGVuZ3RoID0gbGVuZ3RoO1xuICAgIHRoaXMud2lkdGggPSB3aWR0aDtcbiAgICB0aGlzLm1pblBlcnNvbnMgPSBtaW5QZXJzb25zO1xuICAgIHRoaXMubWF4UGVyc29ucyA9IG1heFBlcnNvbnM7XG4gICAgdGhpcy5zcXVhcmVNZXRlciA9IHRoaXMubGVuZ3RoICogdGhpcy53aWR0aDtcbiAgfVxufVxuXG5jbGFzcyBFcXVpcG1lbnQge1xuICBjb25zdHJ1Y3Rvcih0aXRsZSwgcHJpY2UsIGRlc2NyaXB0aW9uKSB7XG4gICAgdGhpcy50aXRsZSA9IHRpdGxlO1xuICAgIHRoaXMucHJpY2UgPSBwcmljZTsgXG4gICAgdGhpcy5kZXNjcmlwdGlvbiA9IGRlc2NyaXB0aW9uO1xuICB9XG59XG5cbnZhciB0ZW50cyA9IFtcbiAgbmV3IFRlbnQoJ1plbHR0aXRlbCAxJywgMTUsIDQsIDIwLCAxMDAsIDE1MCksXG4gIG5ldyBUZW50KCdaZWx0dGl0ZWwgMicsIDMwLCA4LCAyMCwgMjAwLCAzMDApLFxuICBuZXcgVGVudCgnWmVsdHRpdGVsIDMnLCA1MCwgMTIsIDIwLCAxNTAsIDMwMCksXG5dO1xuXG52YXIgZXF1aXBtZW50cyA9IFtcbiAgbmV3IEVxdWlwbWVudCgnTGFtcGUnLCA1LCAna2xlaW5lIExhbXBlIGbDvHIgZGFzIERKIFB1bHQnKSxcbiAgbmV3IEVxdWlwbWVudCgnQm9kZW5wbGF0dGUgMzB4MzAgY20nLCAyLCAnVW0gZGVuIEJvZGVuIHp1IHNjaMO8dHplbicpLFxuICBuZXcgRXF1aXBtZW50KCdUaXNjaCAtIDMgTWV0ZXIgJywgOSwgXCJmw7xyIDYgUGVyc29uZW5cIiksXG4gIG5ldyBFcXVpcG1lbnQoJ1Rpc2NoIC0gNSBNZXRlciAnLCA5LCBcImbDvHIgOSBQZXJzb25lblwiKVxuXTtcblxuY2xhc3MgV2l6YXJkU3RlcCB7XG4gIGNvbnN0cnVjdG9yKG5hbWU9JycsIHdpemFyZEZvcm09bnVsbCkge1xuICAgIHRoaXMubmFtZSA9IG5hbWU7XG4gICAgdGhpcy5hY3RpdmUgPSBrby5vYnNlcnZhYmxlKGZhbHNlKTtcbiAgICB0aGlzLmFjdGl2ZVN1YlN0ZXAgPSBrby5vYnNlcnZhYmxlKCk7XG4gICAgdGhpcy53aXphcmRGb3JtID0gd2l6YXJkRm9ybTtcbiAgICB0aGlzLmlzVmlzaWJsZSA9IGtvLmNvbXB1dGVkKGZ1bmN0aW9uKCkge1xuICAgICAgcmV0dXJuIHRoaXMuYWN0aXZlKCkgJiYgIXRoaXMuYWN0aXZlU3ViU3RlcCgpO1xuICAgIH0sIHRoaXMpO1xuICB9XG4gIG9wZW5TdWJTdGVwKHN1YnN0ZXApIHtcbiAgICBzdWJzdGVwLmFjdGl2ZSh0cnVlKTtcbiAgICB0aGlzLmFjdGl2ZVN1YlN0ZXAoc3Vic3RlcCk7XG4gIH1cbiAgY2xvc2VTdWJTdGVwKCkge1xuICAgIHRoaXMuYWN0aXZlU3ViU3RlcCgpLmFjdGl2ZShmYWxzZSk7XG4gICAgdGhpcy5hY3RpdmVTdWJTdGVwKG51bGwpO1xuICB9XG4gIHJlbW92ZURhdGFSb3coKSB7IHRocm93IG5ldyBFcnJvcignT3ZlcnJpZGUgdGhpcyBmdW5jdGlvbicpOyB9XG59XG5cbmNsYXNzIFdpemFyZFN1YlN0ZXAgZXh0ZW5kcyBXaXphcmRTdGVwIHtcbiAgY29uc3RydWN0b3IocGFyZW50LCAuLi5hcmdzKSB7XG4gICAgc3VwZXIoLi4uYXJncyk7XG4gICAgdGhpcy5wYXJlbnQgPSBwYXJlbnQ7XG4gICAgdGhpcy5pc1Zpc2libGUgPSBrby5jb21wdXRlZChmdW5jdGlvbigpIHtcbiAgICAgIHJldHVybiB0aGlzLmFjdGl2ZSgpICYmIHRoaXMucGFyZW50LmFjdGl2ZSgpO1xuICAgIH0sIHRoaXMpO1xuICB9XG59XG5jbGFzcyBXaXphcmRTdGVwVGVudHMgZXh0ZW5kcyBXaXphcmRTdGVwIHtcbiAgY29uc3RydWN0b3IoLi4uYXJncykge1xuICAgIHN1cGVyKC4uLmFyZ3MpO1xuICAgIHRoaXMuc2VsZWN0VGVudHNTdWJTdGVwID0gbmV3IFdpemFyZFN0ZXBTZWxlY3RUZW50cyh0aGlzKTtcbiAgICB0aGlzLm9wZW5TdWJTdGVwKHRoaXMuc2VsZWN0VGVudHNTdWJTdGVwKTtcbiAgfVxuICBvcGVuU2VsZWN0VGVudCgpIHtcbiAgICB0aGlzLm9wZW5TdWJTdGVwKHRoaXMuc2VsZWN0VGVudHNTdWJTdGVwKTtcbiAgfVxuICByZW1vdmVEYXRhUm93KHRlbnQpIHtcbiAgICB0aGlzLndpemFyZEZvcm0uc2VsZWN0ZWRUZW50cy5yZW1vdmUodGVudCk7XG4gIH1cbn1cblxuY2xhc3MgV2l6YXJkU3RlcEVxdWlwbWVudHMgZXh0ZW5kcyBXaXphcmRTdGVwIHtcbiAgY29uc3RydWN0b3IoLi4uYXJncykge1xuICAgIHN1cGVyKC4uLmFyZ3MpO1xuICAgIHRoaXMuc2VsZWN0RXF1aXBtZW50U3ViU3RlcCA9IG5ldyBXaXphcmRTdGVwU2VsZWN0RXF1aXBtZW50KHRoaXMpO1xuICAgIHRoaXMub3BlblN1YlN0ZXAodGhpcy5zZWxlY3RFcXVpcG1lbnRTdWJTdGVwKTtcbiAgfVxuICBvcGVuU2VsZWN0RXF1aXBtZW50KCkge1xuICAgIHRoaXMub3BlblN1YlN0ZXAodGhpcy5zZWxlY3RFcXVpcG1lbnRTdWJTdGVwKTtcbiAgfVxuICByZW1vdmVEYXRhUm93KGVxdWlwbWVudCkge1xuICAgIHRoaXMud2l6YXJkRm9ybS5zZWxlY3RlZEVxdWlwbWVudHMucmVtb3ZlKGVxdWlwbWVudCk7XG4gIH0gXG59XG5cbmNsYXNzIFdpemFyZFN0ZXBFdmVudCBleHRlbmRzIFdpemFyZFN0ZXAge1xufVxuXG5cbmNsYXNzIFdpemFyZFN0ZXBDb250YWN0IGV4dGVuZHMgV2l6YXJkU3RlcCB7XG4gIGNvbnN0cnVjdG9yKC4uLmFyZ3MpIHtcbiAgICBzdXBlciguLi5hcmdzKTtcbiAgICB0aGlzLmF2YWlsYWJsZUdlbmRlcnMgPSBrby5vYnNlcnZhYmxlQXJyYXkoWycnLCAnSGVycicsICdGcmF1J10pO1xuICB9XG59XG5cbmNsYXNzIFdpemFyZFN0ZXBTZWxlY3RUZW50cyBleHRlbmRzIFdpemFyZFN1YlN0ZXAge1xuICBjb25zdHJ1Y3RvcihwYXJlbnQsIC4uLmFyZ3MpIHtcbiAgICBzdXBlcihwYXJlbnQsIC4uLmFyZ3MpO1xuICB9XG4gIHNlbGVjdFRlbnQodGVudCkge1xuICAgIHRoaXMucGFyZW50LndpemFyZEZvcm0uc2VsZWN0ZWRUZW50cy5wdXNoKE9iamVjdC5hc3NpZ24obmV3IFRlbnQoKSwgdGVudCkpO1xuICAgIHRoaXMucGFyZW50LmNsb3NlU3ViU3RlcCgpO1xuICB9XG59XG5cbmNsYXNzIFdpemFyZFN0ZXBTZWxlY3RFcXVpcG1lbnQgZXh0ZW5kcyBXaXphcmRTdWJTdGVwIHtcbiAgc2VsZWN0RXF1aXBtZW50KGVxdWlwbWVudCkge1xuICAgIHRoaXMucGFyZW50LndpemFyZEZvcm0uc2VsZWN0ZWRFcXVpcG1lbnRzLnB1c2goT2JqZWN0LmFzc2lnbihuZXcgRXF1aXBtZW50KCksIGVxdWlwbWVudCkpO1xuICAgIHRoaXMucGFyZW50LmNsb3NlU3ViU3RlcCgpO1xuICB9XG59XG5jbGFzcyBXaXphcmRGb3JtIHtcbiAgY29uc3RydWN0b3IoKSB7XG4gICAgdGhpcy5maXJzdE5hbWUgPSBrby5vYnNlcnZhYmxlKCk7XG4gICAgdGhpcy5sYXN0TmFtZSA9IGtvLm9ic2VydmFibGUoKTtcbiAgICB0aGlzLnNhbHV0YXRpb24gPSBrby5vYnNlcnZhYmxlKCk7XG4gICAgdGhpcy5jb21wYW55ID0ga28ub2JzZXJ2YWJsZSgpO1xuICAgIHRoaXMuc3RyZWV0ID0ga28ub2JzZXJ2YWJsZSgpO1xuICAgIHRoaXMuc3RyZWV0bnIgPSBrby5vYnNlcnZhYmxlKCk7XG4gICAgdGhpcy56aXAgPSBrby5vYnNlcnZhYmxlKCk7XG4gICAgdGhpcy5sb2NhdGlvbiA9IGtvLm9ic2VydmFibGUoKTtcbiAgICB0aGlzLmVtYWlsID0ga28ub2JzZXJ2YWJsZSgpO1xuICAgIHRoaXMucGhvbmUgPSBrby5vYnNlcnZhYmxlKCk7XG4gICAgdGhpcy5ldmVudGRheXMgPSBrby5vYnNlcnZhYmxlKDEpO1xuICAgIHRoaXMuZXZlbnRsb2NhdGlvbiA9IGtvLm9ic2VydmFibGUoKTtcbiAgICB0aGlzLmV2ZW50bG9jYXRpb25kaXN0YW5jZSA9IGtvLm9ic2VydmFibGUoMCk7XG5cbiAgICB0aGlzLnRlbnRzID0ga28ub2JzZXJ2YWJsZUFycmF5KHRlbnRzLnNvcnQoKGEsIGIpID0+IGEubWluUGVyc29ucyAtIGIubWluUGVyc29ucykpO1xuICAgIHRoaXMuZXF1aXBtZW50cyA9IGtvLm9ic2VydmFibGVBcnJheShlcXVpcG1lbnRzKTtcbiAgICB0aGlzLnNlbGVjdGVkVGVudHMgPSBrby5vYnNlcnZhYmxlQXJyYXkoKTtcbiAgICB0aGlzLnNlbGVjdGVkRXF1aXBtZW50cyA9IGtvLm9ic2VydmFibGVBcnJheSgpO1xuICAgIHRoaXMudHJhbnNwb3J0UHJpY2UgPSBrby5jb21wdXRlZChmdW5jdGlvbigpIHtcbiAgICAgIGlmICggdGhpcy5ldmVudGxvY2F0aW9uZGlzdGFuY2UoKSA8PSAxMDAwMCApIHtcbiAgICAgICAgcmV0dXJuIDA7XG4gICAgICB9IGVsc2Uge1xuICAgICAgICAvLyA1MC4tIGVhY2ggMzBrbSAqIDIgKGZvciB0d2ljZSB0aGUgZGlzdGFuY2UpXG4gICAgICAgIHJldHVybiBNYXRoLmNlaWwodGhpcy5ldmVudGxvY2F0aW9uZGlzdGFuY2UoKSAvIDEwMDAgLyAzMCkgKiA1MCAqIDI7XG4gICAgICB9XG4gICAgfSwgdGhpcyk7XG4gICAgdGhpcy50b3RhbFRlbnRzUHJpY2UgPSBrby5jb21wdXRlZChmdW5jdGlvbigpIHtcbiAgICAgIHJldHVybiB0aGlzLl9jb3VudF9vYmpzX2F0dHJpYnV0ZSh0aGlzLnNlbGVjdGVkVGVudHMoKSwgJ3ByaWNlJyk7XG4gICAgfSwgdGhpcyk7XG4gICAgdGhpcy50b3RhbEVxdWlwbWVudHNQcmljZSA9IGtvLmNvbXB1dGVkKGZ1bmN0aW9uKCkge1xuICAgICAgcmV0dXJuIHRoaXMuX2NvdW50X29ianNfYXR0cmlidXRlKHRoaXMuc2VsZWN0ZWRFcXVpcG1lbnRzKCksICdwcmljZScpO1xuICAgIH0sIHRoaXMpO1xuICAgIHRoaXMudG90YWxQcmljZSA9IGtvLmNvbXB1dGVkKGZ1bmN0aW9uKCkge1xuICAgICAgcmV0dXJuICh0aGlzLnRvdGFsVGVudHNQcmljZSgpICsgdGhpcy50b3RhbEVxdWlwbWVudHNQcmljZSgpKSAqIHRoaXMuZXZlbnRkYXlzKCkgKyB0aGlzLnRyYW5zcG9ydFByaWNlKCk7XG4gICAgfSwgdGhpcyk7XG4gICAgdGhpcy50b3RhbE1pblBlcnNvbnMgPSBrby5jb21wdXRlZChmdW5jdGlvbigpIHtcbiAgICAgIHJldHVybiB0aGlzLl9jb3VudF9vYmpzX2F0dHJpYnV0ZSh0aGlzLnNlbGVjdGVkVGVudHMoKSwgJ21pblBlcnNvbnMnKTtcbiAgICB9LCB0aGlzKTtcbiAgICB0aGlzLnRvdGFsTWF4UGVyc29ucyA9IGtvLmNvbXB1dGVkKGZ1bmN0aW9uKCkge1xuICAgICAgcmV0dXJuIHRoaXMuX2NvdW50X29ianNfYXR0cmlidXRlKHRoaXMuc2VsZWN0ZWRUZW50cygpLCAnbWF4UGVyc29ucycpO1xuICAgIH0sIHRoaXMpO1xuICAgIHRoaXMudG90YWxTcXVhcmVNZXRlcnMgPSBrby5jb21wdXRlZChmdW5jdGlvbigpIHtcbiAgICAgIHJldHVybiB0aGlzLl9jb3VudF9vYmpzX2F0dHJpYnV0ZSh0aGlzLnNlbGVjdGVkVGVudHMoKSwgJ3NxdWFyZU1ldGVyJyk7XG4gICAgfSwgdGhpcyk7XG4gIH1cbiAgX2NvdW50X29ianNfYXR0cmlidXRlKG9ianMsIGF0dHIpIHtcbiAgICBsZXQgdG90YWwgPSAwO1xuICAgIG9ianMuZm9yRWFjaChmdW5jdGlvbihvYmopIHsgdG90YWwgKz0gb2JqW2F0dHJdOyB9KTtcbiAgICByZXR1cm4gdG90YWw7XG4gIH1cbn1cblxuY2xhc3MgV2l6YXJkIHtcbiAgY29uc3RydWN0b3IoKSB7XG4gICAgdGhpcy5kZWJ1ZyA9IGZhbHNlO1xuICAgIGlmICh0eXBlb2YgYWpheHVybCA9PT0gJ3VuZGVmaW5lZCcgKSB7XG4gICAgICAvLyB3b3JkcHJlc3Mgc2V0cyB0aGUgYWpheHVybCBpbiB0aGUgZ2xvYmFsIHNjb3BlLlxuICAgICAgLy8gSWYgdGhlIGFqYXh1cmwgaXMgbm90IGluaXRpYWxpemVkLCB3ZSBhcmUgbm90IGluIGEgd29yZHByZXNzXG4gICAgICAvLyBlbnZpcm9ubWVudC5cbiAgICAgIHRoaXMuZGVidWcgPSB0cnVlO1xuICAgIH1cbiAgICB0aGlzLmZvcm0gPSBuZXcgV2l6YXJkRm9ybSgpO1xuICAgIC8vIDAgPSBGaWxsb3V0LCAxID0gU3VjY2VzcywgMiA9IEVycm9yLCAzID0gcGVuZGluZywgNCA9IEZvcm1WYWxpZGF0aW9uIGVycm9yXG4gICAgdGhpcy5tb2RlID0ga28ub2JzZXJ2YWJsZSgwKTtcbiAgICB0aGlzLnN0ZXBzID0ga28ub2JzZXJ2YWJsZUFycmF5KFtcbiAgICAgIG5ldyBXaXphcmRTdGVwVGVudHMoJ1plbHQnLCB0aGlzLmZvcm0pLFxuICAgICAgbmV3IFdpemFyZFN0ZXBFcXVpcG1lbnRzKCdadWJlaMO2cicsIHRoaXMuZm9ybSksXG4gICAgICBuZXcgV2l6YXJkU3RlcEV2ZW50KCdBbmxhc3MnLCB0aGlzLmZvcm0pLFxuICAgICAgbmV3IFdpemFyZFN0ZXBDb250YWN0KCdLb250YWt0JywgdGhpcy5mb3JtKVxuICAgIF0pO1xuICAgIHRoaXMuYWRkcmVzc05vdEZvdW5kID0ga28ub2JzZXJ2YWJsZShmYWxzZSk7XG4gICAgdGhpcy5jdXJyZW50U3RlcCA9IGtvLm9ic2VydmFibGUodGhpcy5zdGVwcygpWzBdKTtcbiAgICB0aGlzLmlzTGFzdFN0ZXAgPSBrby5jb21wdXRlZChmdW5jdGlvbigpIHtcbiAgICAgIHJldHVybiB0aGlzLmN1cnJlbnRXaXphcmRTdGVwSWQoKSA+PSB0aGlzLnN0ZXBzKCkubGVuZ3RoIC0gMTtcbiAgICB9LCB0aGlzKTtcbiAgICB0aGlzLnNob3dQcmV2QnV0dG9uID0ga28uY29tcHV0ZWQoZnVuY3Rpb24oKSB7XG4gICAgICByZXR1cm4gdGhpcy5jdXJyZW50V2l6YXJkU3RlcElkKCkgPiAwO1xuICAgIH0sIHRoaXMpO1xuICAgIHRoaXMubmV4dEJ1dHRvblRleHQgPSBrby5jb21wdXRlZChmdW5jdGlvbigpIHtcbiAgICAgIGlmICggdGhpcy5pc0xhc3RTdGVwKCkgKSB7XG4gICAgICAgIHJldHVybiBcIk9mZmVydGUgYW5mb3JkZXJuXCI7XG4gICAgICB9XG4gICAgICByZXR1cm4gXCJXZWl0ZXJcIjtcbiAgICB9LCB0aGlzKTtcbiAgICB0aGlzLnNob3dOZXh0QnV0dG9uID0gdHJ1ZTtcbiAgICAvLyB0aGlzLnNob3dTZW5kQnV0dG9uID0ga28uY29tcHV0ZWQoZnVuY3Rpb24oKSB7XG4gICAgLy8gICByZXR1cm4gdGhpcy5jdXJyZW50V2l6YXJkU3RlcElkKCkgPT0gdGhpcy5zdGVwcygpLmxlbmd0aCAtMTtcbiAgICAvLyB9LCB0aGlzKTtcbiAgICBrby5jb21wdXRlZChmdW5jdGlvbigpIHtcbiAgICAgIGZvciAobGV0IHN0ZXAgb2YgdGhpcy5zdGVwcygpKSB7XG4gICAgICAgIHN0ZXAuYWN0aXZlKGZhbHNlKTtcbiAgICAgICAgaWYgKCB0aGlzLmN1cnJlbnRTdGVwKCkgPT0gc3RlcCApIHtcbiAgICAgICAgICBzdGVwLmFjdGl2ZSh0cnVlKTtcbiAgICAgICAgfVxuICAgICAgfVxuICAgIH0sIHRoaXMpO1xuXG4gICAgalF1ZXJ5KGRvY3VtZW50KS5vbignZm9jdXNvdXQnLCAnaW5wdXRbcmVxdWlyZWRdLCBzZWxlY3RbcmVxdWlyZWRdJywgZnVuY3Rpb24oc2VsZikge1xuICAgICAgcmV0dXJuIGZ1bmN0aW9uKCkge1xuICAgICAgICBzZWxmLnZhbGlkYXRlRmllbGQodGhpcyk7XG4gICAgICB9O1xuICAgIH0odGhpcykpO1xuICB9XG4gIG5leHQoKSB7XG4gICAgaWYgKCB0aGlzLmlzTGFzdFN0ZXAoKSApIHtcbiAgICAgIHRoaXMuc2VuZCgpO1xuICAgIH0gZWxzZSB7XG4gICAgICB0aGlzLmN1cnJlbnRTdGVwKHRoaXMuc3RlcHMoKVt0aGlzLmN1cnJlbnRXaXphcmRTdGVwSWQoKSArIDFdKTtcbiAgICB9XG4gIH1cbiAgcHJldmlvdXMoKSB7XG4gICAgdGhpcy5jdXJyZW50U3RlcCh0aGlzLnN0ZXBzKClbdGhpcy5jdXJyZW50V2l6YXJkU3RlcElkKCkgLTFdKTtcbiAgfVxuICBzZW5kKCkge1xuICAgIGpRdWVyeSh3aW5kb3cpLnNjcm9sbFRvcCgwKTtcbiAgICBpZiAoICF0aGlzLnZhbGlkYXRlRm9ybSgpICkge1xuICAgICAgdGhpcy5tb2RlKDQpO1xuICAgICAgcmV0dXJuO1xuICAgIH1cbiAgICB0aGlzLm1vZGUoMyk7XG4gICAgbGV0IHNlbGYgPSB0aGlzO1xuICAgIGxldCBkYXRhID0ge1xuICAgICAgYWN0aW9uOiAna2FoX3NlbmRfdGVudF9jb25maWd1cmF0b3InLFxuICAgICAgZmlyc3ROYW1lOiB0aGlzLmZvcm0uZmlyc3ROYW1lKCksXG4gICAgICBsYXN0TmFtZTogdGhpcy5mb3JtLmxhc3ROYW1lKCksXG4gICAgICBzYWx1dGF0aW9uOiB0aGlzLmZvcm0uc2FsdXRhdGlvbigpLFxuICAgICAgY29tcGFueTogdGhpcy5mb3JtLmNvbXBhbnkoKSxcbiAgICAgIHN0cmVldDogdGhpcy5mb3JtLnN0cmVldCgpLFxuICAgICAgc3RyZWV0bnI6IHRoaXMuZm9ybS5zdHJlZXRucigpLFxuICAgICAgemlwOiB0aGlzLmZvcm0uemlwKCksXG4gICAgICBsb2NhdGlvbjogdGhpcy5mb3JtLmxvY2F0aW9uKCksXG4gICAgICBlbWFpbDogdGhpcy5mb3JtLmVtYWlsKCksXG4gICAgICBwaG9uZTogdGhpcy5mb3JtLnBob25lKCksXG4gICAgICBzZWxlY3RlZFRlbnRzOiB0aGlzLmZvcm0uc2VsZWN0ZWRUZW50cygpLFxuICAgICAgc2VsZWN0ZWRFcXVpcG1lbnRzOiB0aGlzLmZvcm0uc2VsZWN0ZWRFcXVpcG1lbnRzKCksXG4gICAgICB0b3RhbFRlbnRzUHJpY2U6IHRoaXMuZm9ybS50b3RhbFRlbnRzUHJpY2UoKSxcbiAgICAgIHRvdGFsRXF1aXBtZW50c1ByaWNlOiB0aGlzLmZvcm0udG90YWxFcXVpcG1lbnRzUHJpY2UoKSxcbiAgICAgIHRvdGFsUHJpY2U6IHRoaXMuZm9ybS50b3RhbFByaWNlKCksXG4gICAgICB0b3RhbE1pblBlcnNvbnM6IHRoaXMuZm9ybS50b3RhbE1pblBlcnNvbnMoKSxcbiAgICAgIHRvdGFsTWF4UGVyc29uczogdGhpcy5mb3JtLnRvdGFsTWF4UGVyc29ucygpLFxuICAgICAgdG90YWxTcXVhcmVNZXRlcnM6IHRoaXMuZm9ybS50b3RhbFNxdWFyZU1ldGVycygpXG4gICAgfTtcbiAgICBsZXQgcmVxdWVzdCA9IHRoaXMuX21ha2VfcmVxdWVzdChkYXRhKTtcbiAgICByZXF1ZXN0LnRoZW4oXG4gICAgICBmdW5jdGlvbigpIHsgc2VsZi5tb2RlKDEpOyB9LFxuICAgICAgZnVuY3Rpb24oKSB7IHNlbGYubW9kZSgyKTsgfSk7XG4gIH1cbiAgcmVhZGFibGVQcmljZShwcmljZSkge1xuICAgIHJldHVybiBwcmljZSArICcgQ0hGJztcbiAgfVxuICByZWFkYWJsZVBlcnNvbnMobWluUGVyc29ucywgbWF4UGVyc29ucykge1xuICAgIHJldHVybiBtaW5QZXJzb25zICsgJyAtICcgKyBtYXhQZXJzb25zICsgJyBQZXJzb25lbic7XG4gIH1cbiAgY3VycmVudFdpemFyZFN0ZXBJZCgpIHtcbiAgICByZXR1cm4gdGhpcy5zdGVwcygpLmluZGV4T2YodGhpcy5jdXJyZW50U3RlcCgpKTtcbiAgfVxuICBfbWFrZV9yZXF1ZXN0KGRhdGEpIHtcbiAgICBsZXQgc2VsZiA9IHRoaXM7XG4gICAgcmV0dXJuIG5ldyBQcm9taXNlKGZ1bmN0aW9uKHJlc29sdmUsIHJlamVjdCkge1xuXG4gICAgICBpZiAoIHNlbGYuZGVidWcgKSB7XG4gICAgICAgIHdpbmRvdy5zZXRUaW1lb3V0KGZ1bmN0aW9uKCkge1xuICAgICAgICAgIHJlc29sdmUoKTtcbiAgICAgICAgfSwgMjAwMCk7XG4gICAgICB9IGVsc2Uge1xuICAgICAgICBqUXVlcnkucG9zdChhamF4dXJsLCBkYXRhKVxuICAgICAgICAgIC5kb25lKGZ1bmN0aW9uKCkgeyByZXNvbHZlKCk7IH0pXG4gICAgICAgICAgLmZhaWwoZnVuY3Rpb24oKSB7IHJlamVjdCgpOyB9KTtcbiAgICAgIH1cbiAgICB9KTtcbiAgfVxuICB2YWxpZGF0ZUZvcm0oKSB7XG4gICAgbGV0IHZhbGlkID0gdHJ1ZTtcbiAgICBsZXQgc2V0SW52YWxpZEZvcm0gPSB0cnVlO1xuICAgICQoJ2lucHV0W3JlcXVpcmVkXSwgc2VsZWN0W3JlcXVpcmVkXScpLmVhY2goZnVuY3Rpb24oc2VsZikge1xuICAgICAgcmV0dXJuIGZ1bmN0aW9uKGNvdW50ZXIsIGZpZWxkKSB7XG4gICAgICAgIGlmICggIXNlbGYudmFsaWRhdGVGaWVsZChmaWVsZCkgKSB7IFxuICAgICAgICAgIHZhbGlkID0gZmFsc2U7XG4gICAgICAgICAgaWYgKCBzZXRJbnZhbGlkRm9ybSApIHtcbiAgICAgICAgICAgIHNlbGYuY3VycmVudFN0ZXAoXG4gICAgICAgICAgICAgIGtvLmRhdGFGb3IoJChmaWVsZCkuY2xvc2VzdCgnLndpemFyZFN0ZXBWaWV3JylbMF0pXG4gICAgICAgICAgICApO1xuICAgICAgICAgICAgc2V0SW52YWxpZEZvcm0gPSBmYWxzZTtcbiAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgIH07XG4gICAgfSh0aGlzKSk7XG4gICAgcmV0dXJuIHZhbGlkO1xuICB9XG4gIHZhbGlkYXRlRmllbGQoZmllbGQpIHtcbiAgICBsZXQgbXNnQm94ID0gZmllbGQucHJldmlvdXNFbGVtZW50U2libGluZztcbiAgICBpZiAoIGZpZWxkLmNoZWNrVmFsaWRpdHkoKSApIHtcbiAgICAgICQobXNnQm94KS5oaWRlKCk7XG4gICAgICByZXR1cm4gdHJ1ZTtcbiAgICB9IGVsc2Uge1xuICAgICAgbXNnQm94LmlubmVySFRNTCA9IGZpZWxkLnZhbGlkYXRpb25NZXNzYWdlO1xuICAgICAgJChtc2dCb3gpLnNob3coKTtcbiAgICAgIHJldHVybiBmYWxzZTtcbiAgICB9XG4gIH1cbiAgY2FsY3VsYXRlRGlzdGFuY2UocGxhY2UpIHtcbiAgICBsZXQgc2VsZiA9IHRoaXM7XG4gICAgY29uc29sZS5sb2cocGxhY2UpO1xuICAgIGlmICh0eXBlb2YocGxhY2UpID09PSAndW5kZWZpbmVkJykge1xuICAgICAgc2VsZi5hZGRyZXNzTm90Rm91bmQodHJ1ZSk7XG4gICAgICByZXR1cm47XG4gICAgfTtcblxuICAgIGxldCBvcmlnaW4gPSAnSGF1cHRzdHJhc3NlIDk1LCAxNzE1IEFsdGVyc3dpbCwgU2Nod2Vpeic7XG4gICAgbGV0IGRlc3RpbmF0aW9uID0gbmV3IGdvb2dsZS5tYXBzLkxhdExuZyhwbGFjZS5nZW9tZXRyeS5sb2NhdGlvbi5sYXQoKSwgcGxhY2UuZ2VvbWV0cnkubG9jYXRpb24ubG5nKCkpO1xuICAgIGxldCBzZXJ2aWNlID0gbmV3IGdvb2dsZS5tYXBzLkRpc3RhbmNlTWF0cml4U2VydmljZSgpO1xuICAgIHNlcnZpY2UuZ2V0RGlzdGFuY2VNYXRyaXgoe1xuICAgICAgb3JpZ2luczogW29yaWdpbl0sXG4gICAgICBkZXN0aW5hdGlvbnM6IFtkZXN0aW5hdGlvbl0sXG4gICAgICB0cmF2ZWxNb2RlOiBnb29nbGUubWFwcy5UcmF2ZWxNb2RlLkRSSVZJTkcsfSxcbiAgICAgIGZ1bmN0aW9uKHJlc3BvbnNlLCBzdGF0dXMpIHtcbiAgICAgICAgaWYgKHN0YXR1cyA9PSBnb29nbGUubWFwcy5EaXN0YW5jZU1hdHJpeFN0YXR1cy5PSykge1xuICAgICAgICAgIGxldCBkaXN0YW5jZW1hdHJpeCA9IHJlc3BvbnNlLnJvd3NbMF0uZWxlbWVudHNbMF07XG4gICAgICAgICAgaWYgKGRpc3RhbmNlbWF0cml4LnN0YXR1cyA9PSBnb29nbGUubWFwcy5EaXN0YW5jZU1hdHJpeFN0YXR1cy5PSykge1xuICAgICAgICAgICAgc2VsZi5mb3JtLmV2ZW50bG9jYXRpb25kaXN0YW5jZShkaXN0YW5jZW1hdHJpeC5kaXN0YW5jZS52YWx1ZSk7XG4gICAgICAgICAgICBzZWxmLmFkZHJlc3NOb3RGb3VuZChmYWxzZSk7XG4gICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICB9XG4gICAgKTtcblxuICB9XG4gIGluaXRHb29nbGVTZWFyY2goKSB7XG4gICAgLy8gV2UgY2FsbCB0aGlzIGZ1bmNpdG9uIGZyb20gb3V0c2lkZS4gU28gd2UgaGF2ZSB0byBzZXQgXG4gICAgLy8gdGhlIHdpemFyZCBpdHNlbGYgdG8gYmUgYWJsZSB0byBhY2Nlc3MgaXRzIGZ1bmN0aW9ucy5cbiAgICBsZXQgc2VsZiA9IHdpbmRvdy53aXphcmQ7XG4gICAgalF1ZXJ5KHdpbmRvdykub24oJ2xvYWQnLCBmdW5jdGlvbigpIHtcbiAgICAgIHZhciBpbnB1dCA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdldmVudGxvY2F0aW9uJyk7XG4gICAgICB2YXIgc2VhcmNoQm94ID0gbmV3IGdvb2dsZS5tYXBzLnBsYWNlcy5TZWFyY2hCb3goaW5wdXQpO1xuICAgICAgc2VhcmNoQm94LmFkZExpc3RlbmVyKCdwbGFjZXNfY2hhbmdlZCcsIGZ1bmN0aW9uKCkge1xuICAgICAgICBzZWxmLmNhbGN1bGF0ZURpc3RhbmNlKHNlYXJjaEJveC5nZXRQbGFjZXMoKVswXSk7XG4gICAgICB9KTtcbiAgICAgIGdvb2dsZS5tYXBzLmV2ZW50LmFkZERvbUxpc3RlbmVyKGlucHV0LCAna2V5ZG93bicsIGZ1bmN0aW9uKGUpIHsgXG4gICAgICAgIGlmIChlLmtleUNvZGUgPT0gMTMpIHsgXG4gICAgICAgICAgICBlLnByZXZlbnREZWZhdWx0KCk7IFxuICAgICAgICB9XG4gICAgICB9KTsgXG4gICAgfSk7XG4gIH07XG59XG5cbndpbmRvdy53aXphcmQgPSBuZXcgV2l6YXJkKCk7XG52YXIgaW5pdEdvb2dsZVNlYXJjaCA9IHdpbmRvdy53aXphcmQuaW5pdEdvb2dsZVNlYXJjaDtcblxualF1ZXJ5KHdpbmRvdykub24oJ2xvYWQnLCBmdW5jdGlvbigpIHtcbiAga28uYXBwbHlCaW5kaW5ncyh3aW5kb3cud2l6YXJkLCBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnd2l6YXJkLWZvcm0nKSk7XG59KTtcbiJdfQ==
